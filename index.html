<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุฑุญูุชู ูู ุงูุฅุณูุงููุฉ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #006633;
            --primary-dark: #004422;
            --secondary-color: #fdd835;
            --light-bg: #e6f3ee;
            --correct-color: #28a745;
            --incorrect-color: #dc3545;
            --info-color: #17a2b8;
            --font-family: 'Cairo', sans-serif;
            --text-dark: #333;
            --text-light: #555;
            --white-color: #fff;
            --border-radius-main: 15px;
        }

        body {
            font-family: var(--font-family);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: var(--text-dark);
            padding: 10px;
            padding-top: 80px; /* <<< ูุฐุง ุงูุณุทุฑ ููู ูุฅุนุทุงุก ูุณุงุญุฉ ููุดุฑูุท ุงูุนููู */
            box-sizing: border-box;
            background-image: url('Ferst.webp');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(240, 244, 248, 0.85);
            z-index: -1;
        }

        .game-container {
            width: 100%;
            max-width: 800px;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        #landing-screen {
            background-color: transparent;
            padding: 30px 40px;
            border-radius: 0;
            box-shadow: none;
            text-align: center;
            animation: fadeInUp 0.6s ease-out;
            width: 100%;
        }

        .logo {
            max-width: 150px;
            margin-bottom: 20px;
        }

        h1 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 32px;
            line-height: 1.4;
            font-weight: 700;
        }

        .subtitle {
            font-size: 18px;
            color: var(--text-light);
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .features-grid {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 40px;
        }

        .feature-card {
            background-color: var(--white-color);
            padding: 25px;
            border-radius: var(--border-radius-main);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: calc(33.33% - 20px);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .feature-card .icon {
            font-size: 48px;
            color: var(--primary-color);
            display: block;
            margin-bottom: 15px;
        }

        .feature-card h3 {
            color: var(--primary-color);
            font-size: 20px;
            margin-bottom: 10px;
        }

        .feature-card p {
            font-size: 14px;
            color: #777;
            line-height: 1.5;
            margin: 0;
        }
        
        .reset-link-container {
            margin-top: 20px;
            font-size: 14px;
        }
        .reset-link-container a {
            color: var(--text-light);
            text-decoration: none;
        }
        .reset-link-container a:hover {
            text-decoration: underline;
            color: var(--primary-color);
        }

        #start-screen {
            background-color: var(--white-color);
            padding: 30px 40px;
            border-radius: var(--border-radius-main);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            animation: fadeInUp 0.6s ease-out;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: right;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--primary-dark);
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 16px;
            font-family: var(--font-family);
        }

        .action-button {
            width: 100%;
            max-width: 350px;
            padding: 15px;
            border: none;
            border-radius: 30px;
            background-color: var(--primary-color);
            color: var(--white-color);
            font-size: 18px;
            font-weight: bold;
            font-family: var(--font-family);
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 0 auto;
        }

        .action-button:hover {
            background-color: var(--primary-dark);
            transform: scale(1.02);
        }

        .action-button:disabled {
            background-color: var(--text-light);
            cursor: not-allowed;
            transform: none; /* ุฅูุบุงุก ุชุฃุซูุฑ ุงูู hover ุนูุฏ ุงูุชุนุทูู */
        }
        
        .btn-icon {
            transform: scaleX(-1);
        }

        .hidden {
            display: none !important;
        }

        .game-stage {
            background-color: var(--white-color);
            padding: 0;
            border-radius: var(--border-radius-main);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 100%;
            box-sizing: border-box;
            overflow: hidden;
            animation: fadeInUp 0.6s ease-out;
        }

        .scene-image {
            width: 100%;
            height: auto;
            display: block;
        }

        .scene-content {
            padding: 25px;
        }

        .scene-title {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-dark);
            margin-bottom: 20px;
        }

        /* --- START: Guide Help Button Style --- */
        .guide-help-button {
            background-color: var(--info-color);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            border: none;
            font-family: var(--font-family);
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: -10px auto 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        .guide-help-button:hover {
            background-color: #117a8b;
            transform: translateY(-2px);
        }
        .guide-help-button:disabled {
            background-color: #aaa;
            cursor: not-allowed;
            transform: none;
        }
        /* --- END: Guide Help Button Style --- */

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 25px;
        }

        .option-btn {
            position: relative;
            padding: 15px 10px;
            border: 2px solid var(--primary-color);
            background-color: var(--white-color);
            color: var(--primary-color);
            font-size: 16px;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            height: 100%;
            opacity: 0;
            animation: fadeIn 0.5s ease-out forwards;
        }

        .option-btn:hover {
            background-color: var(--light-bg);
            transform: translateY(-2px);
        }

        .option-btn.correct {
            background-color: var(--correct-color);
            color: var(--white-color);
            border-color: var(--correct-color);
        }
        .option-btn.correct:hover {
            background-color: var(--correct-color);
        }
        .option-btn.incorrect {
            background-color: var(--incorrect-color);
            color: var(--white-color);
            border-color: var(--incorrect-color);
        }
        .option-btn.incorrect:hover {
            background-color: var(--incorrect-color);
        }
        
        .option-btn.correct::before, .option-btn.incorrect::before {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 24px;
        }

        .option-btn.correct::before { content: 'โ'; }
        .option-btn.incorrect::before { content: 'โ'; }
        
        .feedback-message {
            opacity: 0;
            transform: translateY(10px);
            visibility: hidden;
            transition: opacity 0.4s ease-out, transform 0.4s ease-out, visibility 0.4s;
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            color: var(--white-color);
        }

        .feedback-message.show {
            opacity: 1;
            transform: translateY(0);
            visibility: visible;
        }

        .feedback-message.correct { background-color: var(--correct-color); }
        .feedback-message.incorrect { background-color: var(--incorrect-color); }
        .feedback-message.info { background-color: var(--info-color); }

        .modal {
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            direction: rtl;
        }

        .modal-content {
            background-color: var(--white-color);
            padding: 30px;
            border-radius: var(--border-radius-main);
            text-align: center;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            animation: slide-down 0.4s ease-out;
        }

        @keyframes slide-down {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translate3d(0, 30px, 0); }
            to { opacity: 1; transform: translate3d(0, 0, 0); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content h2 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        .modal-content p {
            color: var(--text-light);
            font-size: 16px;
        }
        
        #map-scene .options-container .option-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 18px;
            padding: 25px 15px;
        }

        .map-icon {
            font-size: 36px;
            margin-bottom: 5px;
        }

        .progress-bar-container {
            width: 90%;
            background-color: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
            height: 10px;
            margin: 10px auto 20px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
        }

        .progress-bar {
            height: 100%;
            width: 0;
            background-color: var(--primary-color);
            transition: width 0.5s ease;
        }

        #faculties-scene .options-container,
        #exchange-scene .options-container,
        #admission-scene .options-container,
        #studentaffairs-scene .options-container { /* Added studentaffairs */
            grid-template-columns: 1fr;
            max-width: 400px;
            margin: 25px auto 0;
        }

        #faculties-scene .option-btn,
        #exchange-scene .option-btn,
        #admission-scene .option-btn,
        #studentaffairs-scene .option-btn { /* Added studentaffairs */
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            padding: 20px;
            gap: 20px;
            font-size: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        #faculties-scene .option-btn:hover,
        #exchange-scene .option-btn:hover,
        #admission-scene .option-btn:hover,
        #studentaffairs-scene .option-btn:hover { /* Added studentaffairs */
            transform: scale(1.03);
            background-color: var(--primary-color);
            color: var(--white-color);
        }

        #faculties-scene .option-btn span,
        #exchange-scene .option-btn span,
        #admission-scene .option-btn span,
        #studentaffairs-scene .option-btn span { /* Added studentaffairs */
            font-size: 30px;
        }

        #grants-info-scene .scene-content,
        #faculties-info-scene .scene-content,
        #studentaffairs-info-scene .scene-content { /* Added studentaffairs */
            padding: 0;
        }

        .info-header {
            padding: 25px 25px 20px 25px;
            border-bottom: 1px solid #eee;
        }
        
        .info-scene-container {
            max-height: 60vh;
            overflow-y: auto;
            padding: 20px 25px;
            text-align: right;
        }

        /* Styling for Student Affairs Info Scene */
        #studentaffairs-info-scene .info-scene-container h3 {
            font-size: 22px;
            font-weight: bold;
            color: var(--primary-dark);
            margin-top: 25px;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--primary-color);
        }
        #studentaffairs-info-scene .info-scene-container p,
        #studentaffairs-info-scene .info-scene-container li {
            font-size: 16px;
            color: var(--text-light);
            line-height: 1.7;
            margin-bottom: 10px;
        }
        #studentaffairs-info-scene .info-scene-container ul {
            list-style: none;
            padding-right: 0;
        }
        #studentaffairs-info-scene .info-scene-container li {
            padding-right: 25px;
            position: relative;
        }
        #studentaffairs-info-scene .info-scene-container li::before {
            content: '๐น';
            position: absolute;
            right: 0;
            top: 2px;
            color: var(--primary-color);
        }
        
        .grant-category,
        .exchange-category {
            font-size: 22px;
            font-weight: bold;
            color: var(--primary-dark);
            margin-top: 20px;
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 2px solid var(--primary-color);
        }
        .grant-category:first-child,
        .exchange-category:first-child {
            margin-top: 0;
        }
        
        .grant-card,
        .exchange-card {
            background-color: #f9f9f9;
            border-right: 5px solid var(--primary-color);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-right-color 0.3s ease;
        }
        .grant-card:hover,
        .exchange-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
            border-right-color: var(--secondary-color);
        }
        
        .grant-card h3,
        .exchange-card h3 {
            margin: 0 0 10px 0;
            font-size: 18px;
            color: var(--primary-dark);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .grant-percentage,
        .exchange-project {
            background-color: var(--secondary-color);
            color: var(--text-dark);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: bold;
        }

        .grant-details ul,
        .exchange-details ul {
            list-style: none;
            padding-right: 0;
            margin: 0;
            font-size: 14px;
            color: var(--text-light);
        }

        .grant-details li,
        .exchange-details li {
            padding-right: 25px;
            position: relative;
            margin-bottom: 8px;
        }
        .grant-details li::before,
        .exchange-details li::before {
            content: '๐น';
            position: absolute;
            right: 0;
            top: 0;
            color: var(--primary-color);
        }

        .info-footer {
            padding: 20px 25px;
            border-top: 1px solid #eee;
        }
        
        #faculties-info-scene .info-scene-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            text-align: center;
        }

        .college-card {
            background-color: #f9f9f9;
            border-top: 5px solid var(--primary-color);
            border-radius: var(--border-radius-main);
            padding: 25px 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .college-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }

        .college-icon {
            font-size: 48px;
            margin-bottom: 15px;
            color: var(--primary-dark);
        }
        
        .college-card h3 {
            margin: 0 0 10px 0;
            font-size: 20px;
            color: var(--primary-color);
        }

        .college-card p {
            font-size: 15px;
            color: var(--text-light);
            line-height: 1.6;
            margin: 0;
        }
        
        #faculties-list-scene .info-scene-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            text-align: right;
        }

        .college-info-card {
            background-color: #f9f9f9;
            border-right: 5px solid var(--primary-color);
            border-radius: var(--border-radius-main);
            padding: 25px 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .college-info-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
            border-right-color: var(--secondary-color);
        }

        .college-info-card h3 {
            margin: 0 0 10px 0;
            font-size: 20px;
            color: var(--primary-dark);
        }

        .college-info-card p {
            font-size: 15px;
            color: var(--text-light);
            line-height: 1.6;
            margin: 0;
        }

        #college-website-scene .scene-content {
            padding: 20px;
            height: 85vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .website-view-header {
            margin-bottom: 15px;
            display: flex;
            justify-content: flex-end;
        }

        .loader-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
            color: var(--text-light);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        #college-website-iframe {
            width: 100%;
            height: 100%;
            border: 1px solid #ddd;
            border-radius: 10px;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        #college-website-iframe.loaded {
            opacity: 1;
        }

        .admission-card {
            background-color: #f9f9f9;
            border-right: 5px solid var(--primary-color);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            text-align: right;
        }
        
        .admission-card h3 {
            font-size: 20px;
            color: var(--primary-dark);
            margin: 0 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-color);
        }
        
        .admission-card ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .admission-card li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        .admission-card li:last-child {
            border-bottom: none;
        }

        .admission-card .specialization {
            font-size: 16px;
            color: var(--text-dark);
        }

        .admission-card .score {
            font-size: 16px;
            font-weight: bold;
            color: var(--primary-color);
            background-color: var(--light-bg);
            padding: 4px 10px;
            border-radius: 20px;
        }
        
        .admission-card .score.new-major {
            background-color: var(--secondary-color);
            color: var(--text-dark);
        }

        #status-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background-color: var(--primary-dark);
            color: var(--white-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 25px;
            box-shadow: 0 3px 12px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            box-sizing: border-box;
            border-bottom: 3px solid var(--secondary-color);
            transition: top 0.3s ease-in-out;
        }

        #status-bar.hidden {
            top: -100px;
        }

        .status-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        #player-name-display {
            font-weight: bold;
            font-size: 17px;
        }

        #player-score-display {
            background-color: var(--secondary-color);
            color: var(--text-dark);
            padding: 6px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 16px;
        }

        .status-bar-btn {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--white-color);
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 15px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .status-bar-btn:hover {
            background-color: var(--incorrect-color);
            border-color: var(--incorrect-color);
            transform: translateY(-2px);
        }
        
        .status-bar-btn#back-to-map-btn:hover {
            background-color: var(--info-color);
            border-color: var(--info-color);
        }

        .status-section .icon {
            font-size: 22px;
        }

        .ad-modal-content {
            position: relative;
            background-color: transparent;
            padding: 0;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.4);
            border-radius: var(--border-radius-main);
            animation: fadeInUp 0.5s;
        }

        .ad-modal-content img {
            width: 100%;
            display: block;
            border-radius: var(--border-radius-main);
        }

        .close-ad-btn {
            position: absolute;
            top: -15px;
            right: -15px;
            color: #000;
            background-color: var(--white-color);
            font-size: 35px;
            font-weight: bold;
            width: 40px;
            height: 40px;
            line-height: 35px;
            text-align: center;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .close-ad-btn:hover {
            transform: scale(1.1) rotate(90deg);
            color: var(--incorrect-color);
        }
        
        #video-overlay {
            flex-direction: column;
            gap: 20px;
            z-index: 3000;
        }

        #skip-video-btn {
            width: auto;
            padding: 12px 30px;
            background-color: var(--incorrect-color);
            position: absolute;
            bottom: 30px;
            z-index: 3001;
        }

        #skip-video-btn:hover {
            background-color: #a71d2a;
        }
        
        /* --- ุจุฏุงูุฉ ุณุชุงูู ุดุงุดุฉ ุงุฎุชูุงุฑ ุงููุฑุดุฏ (ูุญุฏูุซ) --- */
        .guides-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .guide-card {
            background-color: var(--white-color);
            border: 3px solid transparent;
            border-radius: var(--border-radius-main);
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .guide-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }

        .guide-card.selected {
            border-color: var(--primary-color);
            background-color: var(--light-bg);
            transform: translateY(-8px);
        }

        .guide-icon {
            font-size: 64px; /* ุญุฌู ุงูุฅูููุฌู */
            line-height: 1;
            margin-bottom: 15px;
            background-color: var(--light-bg);
            width: 100px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            border: 4px solid var(--primary-color);
        }

        .guide-card h3 {
            margin: 0 0 5px 0;
            font-size: 20px;
            color: var(--primary-dark);
        }

        .guide-card span {
            font-size: 14px;
            font-weight: bold;
            color: var(--primary-color);
            display: block;
            margin-bottom: 10px;
            min-height: 20px;
        }

        .guide-card p {
            font-size: 13px;
            color: var(--text-light);
            line-height: 1.5;
            margin: 0;
            flex-grow: 1;
        }
        /* --- ููุงูุฉ ุณุชุงูู ุดุงุดุฉ ุงุฎุชูุงุฑ ุงููุฑุดุฏ --- */
        
        @media (max-width: 600px) {
            .options-container {
                grid-template-columns: 1fr;
            }

            .features-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
            }
            .feature-card {
                width: auto; 
                margin-bottom: 0;
            }

            #status-bar {
                padding: 8px 10px;
                flex-direction: column;
                gap: 5px;
                align-items: stretch;
            }

            .status-section {
                width: 100%;
                justify-content: space-between;
                gap: 8px;
            }

            #player-name-display {
                font-size: 15px;
            }

            #player-score-display {
                font-size: 14px;
                padding: 5px 12px;
            }

            .status-bar-btn {
                font-size: 13px;
                padding: 6px 10px;
                gap: 5px;
            }

            .status-section .icon {
                font-size: 20px;
            }

            body {
                padding-top: 125px;
            }
            .guides-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>

    <audio id="correct-sound" src="correct.mp3" preload="auto"></audio>
    <audio id="incorrect-sound" src="funny.mp3" preload="auto"></audio>
    <audio id="transition-sound" src="turning.mp3" preload="auto"></audio>
    <audio id="guide-appears-sound" src="guide_appears.mp3" preload="auto"></audio>

    <div id="status-bar" class="hidden">
        <div class="status-section">
            <span class="icon">๐ค</span>
            <span id="player-name-display"></span>
            <span id="player-score-display"></span>
        </div>
        <div class="status-section">
            <a href="#" id="back-to-map-btn" class="status-bar-btn" aria-label="ุงูุนูุฏุฉ ุฅูู ุงูุฎุฑูุทุฉ">
                <span class="icon">๐บ๏ธ</span>
                ุงูุฎุฑูุทุฉ
            </a>
            <a href="#" id="logout-btn" class="status-bar-btn" aria-label="ุงูุฎุฑูุฌ ูุจุฏุก ุฑุญูุฉ ุฌุฏูุฏุฉ">
                <span class="icon">๐ช</span>
                ุฎุฑูุฌ
            </a>
        </div>
    </div>
    <div class="game-container">
        <div id="landing-screen">
            <img src="logo.webp" alt="ุดุนุงุฑ ุงูุฌุงูุนุฉ ุงูุฅุณูุงููุฉ" class="logo" loading="lazy">
            <h1>ุฑุญูุชู ูุญู ุงููุนุฑูุฉ ูุงูุชููุฒ ุชุจุฏุฃ ุงูุขู</h1>
            <p class="subtitle">ุชุทูู ุงูุฌุงูุนุฉ ุงูุฅุณูุงููุฉ ุจุบุฒุฉ ูุณุงุจูุฉ ุชูุงุนููุฉ ูุฑูุฏุฉ ูุทูุจุฉ ุงูุซุงูููุฉ ุงูุนุงูุฉุ ุงุณุชุนุฏ ูุชุญุฏู ูุนูููุงุชู ูุงูููุฒ ุจุฌูุงุฆุฒ ูููุฉ.</p>
            <div class="features-grid">
                <div class="feature-card">
                    <span class="icon">๐</span>
                    <h3>ุญููููุง ุฅูู ููุญุฉ</h3>
                    <p>ุญููู ุฃุฑุจุงุญู ูููุญุฉ ุฏุฑุงุณูุฉ ุญููููุฉ ุนูุฏ ุงูุชุญุงูู ุจุงูุฌุงูุนุฉ.</p>
                </div>
                <div class="feature-card">
                    <span class="icon">๐ฐ</span>
                    <h3>ุงุฑุจุญ ุฌูุงุฆุฒ ููุฑูุฉ</h3>
                    <p>ุงุฌูุน "ุฌูููุงุช" ุฅููุชุฑูููุฉ ูุน ูู ุฅุฌุงุจุฉ ุตุญูุญุฉ ุชุถุงู ุฅูู ุฑุตูุฏู.</p>
                </div>
                <div class="feature-card">
                    <span class="icon">๐</span>
                    <h3>ุชุญุฏูุงุช ููุชุนุฉ</h3>
                    <p>ุฃุฌุจ ุนู ุฃุณุฆูุฉ ุดููุฉ ูู ูุฌุงูุงุช ูุชููุนุฉ ูุงุฎุชุฑ ุชุฎุตุตู.</p>
                </div>
            </div>
            <button id="show-register-btn" class="action-button">
                <span class="btn-icon">๐</span> ูุง ุชูููุช ุงููุฑุตุฉ - ุณุฌูู ุงูุขู!
            </button>
            <p class="reset-link-container">
                <a href="#" id="reset-progress-btn">ูู ุชุฑูุฏ ุจุฏุก ุฑุญูุฉ ุฌุฏูุฏุฉุ (ุณูุชู ุญุฐู ุงูุชูุฏู ุงูุญุงูู)</a>
            </p>
        </div>

        <div id="start-screen" class="hidden">
            <img src="logo.webp" alt="ุดุนุงุฑ ุงูุฌุงูุนุฉ ุงูุฅุณูุงููุฉ" class="logo" loading="lazy">
            <h1>ุฃููุงู ุจู ูู ุฑุญูุชู ุงูุงูุชุฑุงุถูุฉ</h1>
            <p>ุงุณุชูุดู ุงูุฌุงูุนุฉ ุงูุฅุณูุงููุฉุ ุฃุฌุจ ุนู ุงูุชุญุฏูุงุชุ ูุงุฑุจุญ ููุญุฉ ุฏุฑุงุณูุฉ ุญููููุฉ!</p>
            <form id="player-form">
                <div class="form-group">
                    <label for="name">ุงูุงุณู ุงููุงูู:</label>
                    <input type="text" id="name" placeholder="ูุซุงู: ุฃุญูุฏ ุนูู" required minlength="5">
                </div>
                <div class="form-group">
                    <label for="phone">ุฑูู ุงูุฌูุงู:</label>
                    <input type="tel" id="phone" pattern="^05[9|6|4][0-9]{7}$" placeholder="ูุซุงู: 059xxxxxxx" required>
                </div>
                <div class="form-group">
                    <label for="tawjihi-year">ุณูุฉ ุงูุชูุฌููู:</label>
                    <input type="number" id="tawjihi-year" placeholder="ูุซุงู: 2024" required min="2000">
                </div>
                <button type="submit" class="action-button" disabled>ุงุจุฏุฃ ุงูุฑุญูุฉ!</button>
            </form>
        </div>

        <div id="guide-selection-screen" class="game-stage hidden">
            <div class="scene-content">
                <h2 class="scene-title">ุงุฎุชุฑ ูุฑุดุฏู ูู ุงูุฑุญูุฉ</h2>
                <p>ูู ูุฑุดุฏ ุณููุฏู ูู ูุตุงุฆุญ ูู ููุธูุฑ ุชุฎุตุตู ุงููุฑูุฏ!</p>
                <div class="guides-container">
                    </div>
                <button id="confirm-guide-btn" class="action-button" disabled style="margin-top: 30px;">
                    ุชุฃููุฏ ุงููุฑุดุฏ ูุงูุจุฏุก
                </button>
            </div>
        </div>

        <div id="game-scene" class="hidden">
            
            <div id="gate-scene" class="game-stage hidden"></div>
            <div id="map-scene" class="game-stage hidden">
                <div class="scene-content">
                    <h2 class="scene-title">ุฎุฑูุทุฉ ุงูุฌุงูุนุฉ</h2>
                    <p>ููุฏ ุฏุฎูุช ุงูุญุฑู ุงูุฌุงูุนู! ุงุฎุชุฑ ูุฌูุชู ุงูุชุงููุฉ ูุงุณุชููุงู ุฑุญูุชู.</p>
                    <div class="options-container">
                        <button class="option-btn" data-destination="library"><span class="map-icon">๐</span> ุงูููุชุจุฉ ุงููุฑูุฒูุฉ</button>
                        <button class="option-btn" data-destination="cafeteria"><span class="map-icon">โ</span> ุงููุงูุชูุฑูุง</button>
                        <button class="option-btn" data-destination="faculties-list"><span class="map-icon">๐ข</span> ุงููููุงุช</button>
                        <button class="option-btn" data-destination="grants-info"><span class="map-icon">๐ฐ</span> ุงูููุญ ูุงููุณุงุนุฏุงุช</button>
                        <button class="option-btn" data-destination="hospital"><span class="map-icon">๐ฅ</span> ุงููุณุชุดูู ุงูุฌุงูุนู</button>
                        <button class="option-btn" data-destination="admission-info"><span class="map-icon">๐</span> ุงููุจูู ูุงูุชุณุฌูู</button>
                        <button class="option-btn" data-destination="studentaffairs-info"><span class="map-icon">๐งโ๐</span> ุดุคูู ุงูุทูุจุฉ</button>
                        <button class="option-btn" data-destination="conference"><span class="map-icon">๐๏ธ</span> ูุงุนุฉ ุงููุคุชูุฑุงุช</button>
                        <button class="option-btn" data-destination="stadium"><span class="map-icon">๐๏ธ</span> ููุนุจ ุงูุฌุงูุนุฉ</button>
                        <button class="option-btn" data-destination="exchange-info"><span class="map-icon">๐</span> ุงูุชุจุงุฏู ุงูุฃูุงุฏููู</button>
                        <button class="option-btn" data-destination="certificate" style="grid-column: 1 / -1;"><span class="map-icon">๐</span> ุงูุญุตูู ุนูู ุงูุดูุงุฏุฉ</button>
                    </div>
                </div>
            </div>
            
            <div id="faculties-list-scene" class="game-stage hidden">
                <div class="scene-content">
                    <div class="info-header">
                        <h2 class="scene-title">๐ข ุงุณุชูุดู ูููุงุช ุงูุฌุงูุนุฉ</h2>
                        <p>ุชุนุฑูู ุนูู ุนุงูู ูู ูููุฉ! ุงุถุบุท ุนูู ุฃู ุจุทุงูุฉ ูุชุตูุญ ูููุนูุง ุงูุฑุณููุ ุฃู ุงุจุฏุฃ ุชุญุฏู ุงููุนูููุงุช ูุจุงุดุฑุฉ.</p>
                    </div>
                    
                    <div class="info-scene-container" id="faculties-grid-container">
                    </div>

                    <div class="info-footer">
                        <button id="proceed-to-faculties-quiz-btn" class="action-button">
                            ุฃูุง ุฌุงูุฒ... ุงุจุฏุฃ ุชุญุฏู ุงููููุงุช!
                            <span class="btn-icon">๐ง</span>
                        </button>
                    </div>
                </div>
            </div>

            <div id="college-website-scene" class="game-stage hidden">
            </div>

            <div id="faculties-scene" class="game-stage hidden"></div>
            <div id="tf_questions-scene" class="game-stage hidden"></div>
            <div id="mc_questions-scene" class="game-stage hidden"></div>
            <div id="exchange-scene" class="game-stage hidden"></div>
            <div id="exchange_tf_questions-scene" class="game-stage hidden"></div>
            <div id="exchange_mc_questions-scene" class="game-stage hidden"></div>
            <div id="library-scene" class="game-stage hidden"></div>
            
            <div id="admission-info-scene" class="game-stage hidden">
                <div class="scene-content">
                    <div class="info-header">
                        <h2 class="scene-title">๐ ููุชุงุญ ุงูุชูุณูู 2024-2025</h2>
                        <p>ุงุทูุน ุนูู ูุนุฏูุงุช ุงููุจูู ุงููุทููุจุฉ ููููุงุช ุงูุฌุงูุนุฉ ุงููุฎุชููุฉ ูุจู ุจุฏุก ุงูุชุญุฏู.</p>
                    </div>
                    
                    <div class="info-scene-container" id="admission-info-container">
                    </div>
                    
                    <div class="info-footer">
                        <button id="start-admission-quiz-btn" class="action-button">
                            ูููุช... ุงุจุฏุฃ ุงูุชุญุฏู ุงูุขู!
                            <span class="btn-icon">๐ก</span>
                        </button>
                    </div>
                </div>
            </div>

            <div id="admission-scene" class="game-stage hidden"></div>
            <div id="admission_tf_questions-scene" class="game-stage hidden"></div>
            <div id="admission_mc_questions-scene" class="game-stage hidden"></div>
            
            <div id="grants-info-scene" class="game-stage hidden">
                <div class="scene-content">
                    <div class="info-header">
                        <h2 class="scene-title">๐ฐ ุฏููู ุงูููุญ ูุงููุณุงุนุฏุงุช ุงูุทูุงุจูุฉ</h2>
                        <p>ุงููุนุฑูุฉ ููุฉ! ูุจู ุฃู ุชุจุฏุฃ ุงูุชุญุฏูุ ุงุทูุน ุนูู ุฏููู ุงูููุญ ุงูุดุงูู ุงูุฐู ุชูุฏูู ุงูุฌุงูุนุฉ. ูู ูุนูููุฉ ููุง ูุฏ ุชููู ููุชุงุญู ููุญุตูู ุนูู ุฏุนู ูุจูุฑ.</p>
                    </div>
                    
                    <div class="info-scene-container">
                        <h3 class="grant-category">๐ ููุญ ุงูุชููู ุงูุฃูุงุฏููู</h3>
                        <div class="grant-card">
                            <h3>๐ฅ ููุญุฉ ุงูุงูุชูุงุฒ (ุญุณุจ ุงููุนุฏู ุงููุตูู) <span class="grant-percentage">70%</span></h3>
                            <div class="grant-details"><ul><li>ุงููุนุฏู ุงููุทููุจ: 95% - 100% ูุตููุงู</li><li>ูุฌุจ ุงุฌุชูุงุฒ 15 ุณุงุนุฉ ูุนุชูุฏุฉ ุนูู ุงูุฃูู.</li></ul></div>
                        </div>
                        <div class="grant-card">
                            <h3>๐ฅ ููุญุฉ ุงูุงูุชูุงุฒ (ุญุณุจ ุงููุนุฏู ุงููุตูู) <span class="grant-percentage">35%</span></h3>
                            <div class="grant-details"><ul><li>ุงููุนุฏู ุงููุทููุจ: 90% - 94.9% ูุตููุงู</li><li>ูุฌุจ ุงุฌุชูุงุฒ 15 ุณุงุนุฉ ูุนุชูุฏุฉ ุนูู ุงูุฃูู.</li></ul></div>
                        </div>
                        <div class="grant-card">
                            <h3>๐๏ธ ููุญุฉ ูุฒุงุฑุฉ ุงูุชุฑุจูุฉ ูุงูุชุนููู <span class="grant-percentage">70%+</span></h3>
                            <div class="grant-details"><ul><li>ุงููุนุฏู ุงููุทููุจ: ุฃุนูู ูุนุฏููู ูู ูู ูููุฉ</li><li>ููุงุณุชูุฑุงุฑูุฉ: ูุนุฏู ูุตูู 80%</li><li>ูุชู ุงุฎุชูุงุฑูู ุนุจุฑ ุงููุฒุงุฑุฉ.</li></ul></div>
                        </div>

                        <h3 class="grant-category">๐ ููุญ ุงูุชุฎุตุตุงุช ุงูุฃูุงุฏูููุฉ</h3>
                        <div class="grant-card">
                            <h3>๐ ุงูููุญุฉ ุงูุดุฑุนูุฉ <span class="grant-percentage">70%</span></h3>
                            <div class="grant-details"><ul><li>ููุชุฎุตุตุงุช: ุงูุดุฑูุนุฉ ุงูุฅุณูุงููุฉุ ุฃุตูู ุงูุฏูู (ุนุงู)</li><li>ูุนุฏู ุงูุซุงูููุฉ: 80% ูุฃูุซุฑ</li><li>ููุงุณุชูุฑุงุฑูุฉ: ูุนุฏู ูุตูู 80%</li></ul></div>
                        </div>
                            <div class="grant-card">
                            <h3>๐ ุงูููุญุฉ ุงูุดุฑุนูุฉ <span class="grant-percentage">35%</span></h3>
                            <div class="grant-details"><ul><li>ููุชุฎุตุตุงุช: ุงูุดุฑูุนุฉ ุงูุฅุณูุงููุฉุ ุฃุตูู ุงูุฏูู (ุนุงู)</li><li>ูุนุฏู ุงูุซุงูููุฉ: 70% - 79.9%</li><li>ููุงุณุชูุฑุงุฑูุฉ: ูุนุฏู ูุตูู 80%</li></ul></div>
                        </div>
                        <div class="grant-card">
                            <h3>๐งช ููุญ ูููุฉ ุงูุนููู (ููุฒูุงุก ูููููุงุก) <span class="grant-percentage">70%</span></h3>
                            <div class="grant-details"><ul><li>ููุญุชุงู ูุงููุชุงู ุณูููุงู ููู ุชุฎุตุต (ููุฒูุงุก/ููููุงุก)</li><li>ูููุชููููู ูู ุงูุซุงูููุฉ ุงูุนุงูุฉ ูุงููุงุฏุฉ ุงูุนูููุฉ.</li></ul></div>
                        </div>

                        <h3 class="grant-category">โจ ููุญ ุงูููุงูุจ ูุงููุฆุงุช ุงูุฎุงุตุฉ</h3>
                        <div class="grant-card">
                            <h3>๐ ููุญุฉ ุญูุธุฉ ุงููุฑุขู ุงููุฑูู <span class="grant-percentage">50%</span></h3>
                            <div class="grant-details"><ul><li>ููุงุณุชูุฑุงุฑูุฉ: ูุนุฏู ูุตูู 80%</li><li>ูุฌุจ ุงููุฌุงุญ ูู ุงูุชุญุงู ุงูุชุณููุน ููุงูู ุงููุฑุขู.</li></ul></div>
                        </div>
                        <div class="grant-card">
                            <h3>๐ ุงูููุญุฉ ุงูุฑูุงุถูุฉ <span class="grant-percentage">25-35%</span></h3>
                            <div class="grant-details"><ul><li>ููุงุณุชูุฑุงุฑูุฉ: ูุนุฏู ูุตูู 65%</li><li>ููุทูุจุฉ ุงูููุชุญููู ุจูุฑู ุงูุฌุงูุนุฉ ุงูุฑูุงุถูุฉ.</li></ul></div>
                        </div>
                        <div class="grant-card">
                            <h3>โฟ ููุญุฉ ุฐูู ุงูุงุญุชูุงุฌุงุช ุงูุฎุงุตุฉ <span class="grant-percentage">35-70%</span></h3>
                            <div class="grant-details"><ul><li>ููุงุณุชูุฑุงุฑูุฉ: ูุนุฏู ูุตูู 65%</li><li>35% ููุฅุนุงูุฉ (50-69%)ุ ู 70% ููุฅุนุงูุฉ (70% ูุฃูุซุฑ).</li></ul></div>
                        </div>

                        <h3 class="grant-category">๐จโ๐ฉโ๐งโ๐ฆ ููุญ ุงูุฏุนู ุงูุฃุณุฑู ูุงููุฌุชูุนู</h3>
                        <div class="grant-card">
                            <h3>๐งโ๐คโ๐ง ููุญุฉ ุงูุฃุณุฑุฉ (ุดูููุงู) <span class="grant-percentage">15%</span></h3>
                            <div class="grant-details"><ul><li>ููุงุณุชูุฑุงุฑูุฉ: ูุนุฏู 70% (75% ููุทุจ)</li><li>ููู ุทุงูุจ ุนูู ุญุฏุฉ.</li></ul></div>
                        </div>
                            <div class="grant-card">
                            <h3>๐ช ููุญุฉ ุงูุฃุณุฑุฉ (3 ุฃุดูุงุก) <span class="grant-percentage">25%</span></h3>
                            <div class="grant-details"><ul><li>ููุงุณุชูุฑุงุฑูุฉ: ูุนุฏู 70% (75% ููุทุจ)</li><li>ููู ุทุงูุจ ุนูู ุญุฏุฉ.</li></ul></div>
                        </div>
                            <div class="grant-card">
                            <h3>๐จโ๐งโ๐ฆ ููุญุฉ ุงูุฃุณุฑุฉ (4 ุฃุดูุงุก ูุฃูุซุฑ) <span class="grant-percentage">30%</span></h3>
                            <div class="grant-details"><ul><li>ููุงุณุชูุฑุงุฑูุฉ: ูุนุฏู 70% (75% ููุทุจ)</li><li>ููู ุทุงูุจ ุนูู ุญุฏุฉ.</li></ul></div>
                        </div>
                        <div class="grant-card">
                            <h3>๐ผ ููุญุฉ ุฃุจูุงุก ุงูุนุงูููู <span class="grant-percentage">50%</span></h3>
                            <div class="grant-details"><ul><li>ููุงุณุชูุฑุงุฑูุฉ: ูุนุฏู ูุตูู 65%</li><li>ุชุดูู ุฃุจูุงุก ุงูุนุงูููู ููุฌูุณ ุงูุฃููุงุก.</li></ul></div>
                        </div>
                            <div class="grant-card">
                            <h3>โค๏ธ ููุญ ุงูุฃุณุฑู ูุงูุดูุฏุงุก ูุงูุฃูุชุงู <span class="grant-percentage">70%+</span></h3>
                            <div class="grant-details"><ul><li>ููุงุณุชูุฑุงุฑูุฉ: ูุนุฏู ูุตูู 80%</li><li>ุชุชููุฑ ููุญ ูุฎุชููุฉ ููุฐู ุงููุฆุงุช ูุชุชุทูุจ ุฅุซุจุงุชุงุช ุฑุณููุฉ.</li></ul></div>
                        </div>
                    </div>

                    <div class="info-footer">
                        <button id="start-grants-quiz-btn" class="action-button">
                            ูููุช... ุงุจุฏุฃ ุงูุชุญุฏู ุงูุขู!
                            <span class="btn-icon">๐ก</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="grants-scene" class="game-stage hidden"></div>
            
            <div id="exchange-info-scene" class="game-stage hidden">
                <div class="scene-content">
                    <div class="info-header">
                        <h2 class="scene-title">๐ ุฏููู ุงูุชุจุงุฏู ุงูุฃูุงุฏููู</h2>
                        <p>ุชูุชู ุงูุนูุงูุงุช ุงูุฎุงุฑุฌูุฉ ุจุชูููุฑ ูุฑุต ุชุจุงุฏู ุฃูุงุฏููู ูููุฒุฉ. ุชุนุฑูู ุนูู ูุฐู ุงููุฑุต ูุจู ุฃู ุชุจุฏุฃ ุงูุชุญุฏู.</p>
                    </div>
                    <div class="info-scene-container">
                        <div class="exchange-card">
                            <h3>ุจุฑุงูุฌ ุงูุชุจุงุฏู ุงูุฑุฆูุณูุฉ</h3>
                            <div class="exchange-details">
                                <ul>
                                    <li>ุชูุฏู ุฅูู ุงูุชุจุงุฏู ุงูุซูุงูู ูููู ุงูุฎุจุฑุงุช ูุชุญุณูู ุงููุฏุฑุงุช ุงููุคุณุณูุฉ.</li>
                                    <li>ุชุดูู ุจุฑุงูุฌ ุงูุจูุงููุฑููุณุ ุงููุงุฌุณุชูุฑุ ุงูุฏูุชูุฑุงูุ ููุง ุจุนุฏ ุงูุฏูุชูุฑุงู.</li>
                                    <li>ุชูููุฐ ุจุงูุดุฑุงูุฉ ูุน ุฌุงูุนุงุช ูู ุฃูุฑูุจุงุ ุชุฑููุงุ ููุงููุฒูุง.</li>
                                </ul>
                            </div>
                        </div>
                        <h3 class="exchange-category">ุฃุดูุฑ ุจุฑุงูุฌ ุงูุชุจุงุฏู</h3>
                        <div class="exchange-card">
                            <h3>Erasmus Mundus <span class="exchange-project">ูุดุงุฑูุน ุชุจุงุฏู</span></h3>
                            <div class="exchange-details">
                                <ul>
                                    <li>ุญุตูุช ุงูุฌุงูุนุฉ ุนูู ุชูููู ูู 6 ูุดุงุฑูุน.</li>
                                    <li>ุจุงูุดุฑุงูุฉ ูุน 70 ุฌุงูุนุฉ ูุญููุฉ ูุฅูููููุฉ ูุฏูููุฉ.</li>
                                    <li>ุชู ุชูููุฐูุง ุฎูุงู ุงููุชุฑุฉ ูู 2012 ูุญุชู 2017.</li>
                                </ul>
                            </div>
                        </div>
                        <div class="exchange-card">
                            <h3>Erasmus+ <span class="exchange-project">ุญุฑุงู ุนููู</span></h3>
                            <div class="exchange-details">
                                <ul>
                                    <li>ุดุงุฑูุช ุงูุฌุงูุนุฉ ุจุฃูุซุฑ ูู 12 ูุดุฑูุนุงู.</li>
                                    <li>ูุดุงุฑูุน ุงูุชุจุงุฏู ุงูุฃูุงุฏููู ุฎูุงู ุงููุชุฑุฉ ูู 2016-2019.</li>
                                </ul>
                            </div>
                        </div>
                        <div class="exchange-card">
                            <h3>Mevlana <span class="exchange-project">ุจุฑูุงูุฌ ุชุฑูู</span></h3>
                            <div class="exchange-details">
                                <ul>
                                    <li>ุจุฑูุงูุฌ ุงูุชุจุงุฏู ุงูุซูุงูู ุงูุชุฑูู.</li>
                                    <li>ุชูุช ุงููุดุงุฑูุฉ ูุน 6 ุฌุงูุนุงุช ุชุฑููุฉ.</li>
                                    <li>ุชู ุชูููุฐู ุฎูุงู ุงููุชุฑุฉ ูู 2013-2021.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="info-footer">
                        <button id="start-exchange-quiz-btn" class="action-button">
                            ูููุช... ุงุจุฏุฃ ุงูุชุญุฏู ุงูุขู!
                            <span class="btn-icon">๐ก</span>
                        </button>
                    </div>
                </div>
            </div>

            <div id="studentaffairs-info-scene" class="game-stage hidden">
                <div class="scene-content">
                    <div class="info-header">
                        <h2 class="scene-title">๐งโ๐ ุนูุงุฏุฉ ุดุคูู ุงูุทูุจุฉ</h2>
                        <p>ุชูุนูู ุงูุนูุงุฏุฉ ุจุชูุฏูู ุงูุฎุฏูุงุช ุงูุทูุงุจูุฉ ูุชูุธูู ุงูุฃูุดุทุฉ ุงูุชู ุชุณุงูู ูู ุตูู ุดุฎุตูุฉ ุงูุทุงูุจ. ุชุนุฑูู ุนูููุง ูุจู ุจุฏุก ุงูุชุญุฏู.</p>
                    </div>
                    <div class="info-scene-container" id="studentaffairs-info-container">
                        </div>
                    <div class="info-footer">
                        <button id="start-studentaffairs-quiz-btn" class="action-button">
                            ูููุช... ุงุจุฏุฃ ุชุญุฏู ุดุคูู ุงูุทูุจุฉ!
                            <span class="btn-icon">โ</span>
                        </button>
                    </div>
                </div>
            </div>

            <div id="studentaffairs-scene" class="game-stage hidden"></div>
            <div id="studentaffairs_tf_questions-scene" class="game-stage hidden"></div>
            <div id="studentaffairs_mc_questions-scene" class="game-stage hidden"></div>
            <div id="end-scene" class="game-stage hidden">
                <div class="scene-content">
                    <h2 class="scene-title">๐ ุชูุงูููุง! ๐</h2>
                    <img src="https://placehold.co/400x250/28a745/FFFFFF?text=ุดูุงุฏุฉ+ุดูุฑ" alt="ุดูุงุฏุฉ ูุดุงุฑูุฉ" class="scene-image" style="max-width: 100%; border-radius: 10px; margin-bottom: 20px;" loading="lazy">
                    <p id="final-message" style="font-size: 18px; line-height: 1.6;"></p>
                    <button id="share-btn" class="action-button">ูุดุงุฑูุฉ ุนูู ูุณุงุฆู ุงูุชูุงุตู</button>
                    <button id="new-player-btn" class="action-button" style="margin-top: 10px; background-color: var(--text-light);">ุจุฏุก ุฑุญูุฉ ุฌุฏูุฏุฉ (ูุงุนุจ ุฌุฏูุฏ)</button>
                </div>
            </div>
        </div>
    </div>

    <div id="feedback-modal" class="modal hidden">
        <div class="modal-content">
            <h2 id="modal-title"></h2>
            <div id="modal-text"></div>
            <button id="modal-close-btn" class="action-button">ูุชุงุจุนุฉ</button>
        </div>
    </div>

    <div id="ad-modal" class="modal hidden">
        <div class="ad-modal-content">
            <span class="close-ad-btn">&times;</span>
            <img src="eng.webp" alt="ุฅุนูุงู ูููุฉ ุงูููุฏุณุฉ" loading="lazy">
        </div>
    </div>

    <div id="video-overlay" class="modal hidden">
        <video id="welcome-video" width="90%" style="max-width: 800px; border-radius: 15px;">
            <source src="hares 1.mp4" type="video/mp4">
            ูุชุตูุญู ูุง ูุฏุนู ุนุฑุถ ุงูููุฏูู.
        </video>
        <button id="skip-video-btn" class="action-button">ุชุฎุทู ุงูููุฏูู</button>
    </div>
    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby2RjbdyISPTbhfR8h-lE41eY0lEWEOxZevGyTMxNbpY2zTmRzWa3DEAd5Dc6O72GgtMA/exec';
        
        const form = document.getElementById('player-form');
        if(form){
            const startBtn = form.querySelector('button');
            const inputs = form.querySelectorAll('input[required]');
            form.addEventListener('input', () => {
                startBtn.disabled = !form.checkValidity();
            });
        }

        function registerPlayer(name, phone, year) {
            const formData = new FormData();
            formData.append('action', 'register');
            formData.append('name', name);
            formData.append('phone', phone);
            formData.append('year', year);
            return fetch(SCRIPT_URL, { method: 'POST', body: formData }).then(response => response.json());
        }
        
        function updatePlayerScore(uniqueId, score) {
            if (!uniqueId) {
                console.error("Attempted to update score without a uniqueId.");
                return;
            }
            const formData = new FormData();
            formData.append('action', 'updateScore');
            formData.append('uniqueId', uniqueId);
            formData.append('score', score);
            fetch(SCRIPT_URL, { method: 'POST', body: formData })
                .then(response => response.json())
                .then(data => {
                    if (data.result === 'success') {
                        console.log(`Score updated to: ${score}`);
                    } else {
                        console.error('Error updating score:', data.message);
                    }
                })
                .catch(error => console.error('Error in update fetch:', error));
        }

        function shuffleArray(array) {
            let currentIndex = array.length, randomIndex;
            const newArray = [...array]; 
            
            while (currentIndex !== 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [newArray[currentIndex], newArray[randomIndex]] = [
                    newArray[randomIndex], newArray[currentIndex]
                ];
            }
            return newArray;
        }

        document.addEventListener('DOMContentLoaded', () => {
            const collegesData = [
                { name: 'ูููุฉ ุงูุทุจ', description: 'ุงูุทุจ ูุนูููู ูุทุจูุจู ูููุณุชูุจู', url: 'https://medicine.iugaza.edu.ps/', emoji: 'โ๏ธ' },
                { name: 'ูููุฉ ุงูููุฏุณุฉ', description: 'ููุฏุณุฉ ุงููุณุชูุจู ุจูุงูุฉ ูุฌุงูุงุช ุงูุญูุงุฉ', url: 'https://eng.iugaza.edu.ps/', emoji: '๐๏ธ' },
                { name: 'ูููุฉ ุชูููููุฌูุง ุงููุนูููุงุช', description: 'ุนุตุฑ ุงูุชูููููุฌูุง ูุงููุนูููุงุชูุฉ ูุฃูู ุงููุนูููุงุช ูุงูุจูุงูุงุช', url: 'https://fit.iugaza.edu.ps/', emoji: '๐ป' },
                { name: 'ูููุฉ ุงูุชูุฑูุถ', description: 'ุจุฐูู ูุนุทุงุกู ูุชูุงูู ููู ูุฑูุถ ููู ูู ููุงู', url: 'https://nursing.iugaza.edu.ps/', emoji: '๐ฉบ' },
                { name: 'ูููุฉ ุงูุนููู ุงูุตุญูุฉ', description: 'ุงูุนูุงุฌ ุงูุณููู ูุจุฏุฃ ูู ููุง', url: 'https://healthscience.iugaza.edu.ps/', emoji: '๐งฌ' },
                { name: 'ูููุฉ ุงูุนููู', description: 'ุนููู ุงูุทุจูุนุฉ ูุฃุณุฑุงุฑ ุงูููู', url: 'https://science.iugaza.edu.ps/', emoji: '๐ฌ' },
                { name: 'ูููุฉ ุงูุขุฏุงุจ', description: 'ุนููู ููุบุงุชู ูุฃุฏุจู ูุซูุงูุฉ ุงูุฃูู ุงููุฎุชููุฉ ูุฏููุงู ูุญุฏูุซุงู', url: 'https://arts.iugaza.edu.ps/', emoji: '๐' },
                { name: 'ูููุฉ ุงูุดุฑูุนุฉ ูุงููุงููู', description: 'ุฏุฑุงุณุฉ ููุดุฑูุนุฉ ุงูุงุณูุงููุฉ ูุงููุญุงูุงุฉ ุนูู ูุจุงุฏุฆ ุงูุดุฑูุนุฉ ุงูุณูุญุฉ', url: 'https://sharea.iugaza.edu.ps/', emoji: 'โ๏ธ' },
                { name: 'ูููุฉ ุฃุตูู ุงูุฏูู', description: 'ุงูุฏูู ุงูุฅุณูุงูู ุ ุฃุตููู ูุฃุญูุงูู', url: 'https://osool.iugaza.edu.ps/', emoji: '๐' },
                { name: 'ูููุฉ ุงูุชุฑุจูุฉ', description: 'ูุนููู .. ูุฑุจู ุฃุฌูุงู ุงููุณุชูุจู ุงููุณุชููุฑุฉ', url: 'https://education.iugaza.edu.ps/', emoji: '๐ฉโ๐ซ' },
                { name: 'ูููุฉ ุงูุงูุชุตุงุฏ ูุงูุนููู ุงูุฅุฏุงุฑูุฉ', description: 'ุจูุงุก ุงูุงูุชุตุงุฏ ูุงูุฅุฏุงุฑุฉ ุงูุณูููุฉ ูุงููุงู', url: 'https://commerce.iugaza.edu.ps/', emoji: '๐ผ' }
            ];

            const allGuides = [
                { id: 'medicine', name: 'ุฏ. ุฎุงูุฏ', college: 'ูููุฉ ุงูุทุจ', emoji: 'โ๏ธ', description: 'ุงูุฏูุฉ ูุงูุชุดุฎูุต ุงูุณููู ููุง ููุชุงุญ ุงููุฌุงุญ. ุณุฃุฑุดุฏู ูู ุฑุญูุฉ ูุนุฑููุฉ ุตุญูุฉ.' },
                { id: 'engineering', name: 'ู. ุณุงุฑุฉ', college: 'ูููุฉ ุงูููุฏุณุฉ', emoji: '๐๏ธ', description: 'ูู ูุดุฑูุน ุนุธูู ูุจุฏุฃ ุจุชุตููู ุฏููู. ููุจูู ูุณุชูุจูู ุฎุทูุฉ ุจุฎุทูุฉ.' },
                { id: 'it', name: 'ูุจุฑูุฌ ุจุฏุฑ', college: 'ูููุฉ ุชูููููุฌูุง ุงููุนูููุงุช', emoji: '๐ป', description: 'ูู ุนุงูู ุงูุฃููุงุฏุ ูู ูุดููุฉ ููุง ุญู. ุณุฃุณุงุนุฏู ุนูู ุงูุชูููุฑ ุจููุทููุฉ ูุฅูุฌุงุฏ ุงูุญููู.' },
                { id: 'nursing', name: 'ููุฑุถุฉ ุฃูู', college: 'ูููุฉ ุงูุชูุฑูุถ', emoji: '๐ฉบ', description: 'ุงูุฑุญูุฉ ูุงูุนูุงูุฉ ููุง ุฃุณุงุณ ูููุชูุง. ุณุฃููู ุจุฌุงูุจู ูุฃูููู ุงูุนุทุงุก.' },
                { id: 'health_sciences', name: 'ุฃุฎุตุงุฆู ุฑุงูู', college: 'ูููุฉ ุงูุนููู ุงูุตุญูุฉ', emoji: '๐งฌ', description: 'ุตุญุฉ ุงููุฌุชูุน ุชุจุฏุฃ ูู ุงููุฎุชุจุฑ. ูุนูุง ุณููุชุดู ุฃุณุฑุงุฑ ุงูููุงูุฉ ูุงูุนูุงุฌ.' },
                { id: 'sciences', name: 'ุนุงููุฉ ููุฑ', college: 'ูููุฉ ุงูุนููู', emoji: '๐ฌ', description: 'ุงูููู ูููุก ุจุงูุฃุณุฆูุฉุ ูุงูุนููู ูู ูุณููุชูุง ููุฅุฌุงุจุฉ. ุฏุนูุง ูุณุชูุดู ุจุดุบู.' },
                { id: 'arts', name: 'ุฃุฏูุจุฉ ูููู', college: 'ูููุฉ ุงูุขุฏุงุจ', emoji: '๐', description: 'ุงููููุงุช ุชุจูู ุงูุญุถุงุฑุงุช. ุณุฃุฌุนู ุฑุญูุชู ูููุฆุฉ ุจุงูุฅุจุฏุงุน ูุงููุนุงูู ุงูุฌูููุฉ.' },
                { id: 'law', name: 'ูููู ููุณู', college: 'ูููุฉ ุงูุดุฑูุนุฉ ูุงููุงููู', emoji: 'โ๏ธ', description: 'ุงูุนุฏู ูู ุฃุณุงุณ ุงูููู. ุณุฃุนููู ููู ุชูุงุฒู ุจูู ุงูุญููู ูุงููุงุฌุจุงุช.' },
                { id: 'religion', name: 'ุฏุงุนูุฉ ุฅููุงู', college: 'ูููุฉ ุฃุตูู ุงูุฏูู', emoji: '๐', description: 'ุงูุนูู ุจุงูุฏูู ูููุฑ ุงูุฏุฑุจ. ุณุฃุฑุงููู ูู ุฑุญูุฉ ูููู ููุงุตุฏ ุดุฑูุนุชูุง ุงูุณูุญุฉ.' },
                { id: 'education', name: 'ุฃุณุชุงุฐุฉ ูุฏู', college: 'ูููุฉ ุงูุชุฑุจูุฉ', emoji: '๐ฉโ๐ซ', description: 'ุจูุงุก ุงูุฃุฌูุงู ูู ุฃุณูู ุงูุฑุณุงูุงุช. ูุนูุง ุณูุชุนูู ููู ูููู ุงูุนููู ููุจูู ุงููุณุชูุจู.' },
                { id: 'economics', name: 'ุฎุจูุฑ ูุงูู', college: 'ูููุฉ ุงูุงูุชุตุงุฏ', emoji: '๐ผ', description: 'ููู ุงููุงู ูุงูุงูุชุตุงุฏ ูู ููุชุงุญ ุจูุงุก ูุณุชูุจู ูุฒุฏูุฑ. ุฏุนูุง ูุฎุทุท ููุฌุงุญู.' }
            ];

            const guideMessages = {
                'gate': {
                    medicine: "ูุฑุญุจุงู ุจู! ุงูุฏุฎูู ููุฌุงูุนุฉ ูุดุจู ุงูุชุดุฎูุต ุงูุฃููุ ูุฌุจ ุฃู ูููู ุฏูููุงู. ุฑูุฒ ุฌูุฏุงู.",
                    engineering: "ุฃููุงู ุจู. ูุฐู ุงูุจูุงุจุฉ ูู ุฃุณุงุณ ูุดุฑูุนู ุงูุชุนูููู. ููุจุฏุฃ ุจุจูุงุก ูุชูู!",
                    it: "ูุตุงุฏูุฉ ูุงุฌุญุฉ! ููุฏ ุชุฌุงูุฒุช ุฌุฏุงุฑ ุงูุญูุงูุฉ ุงูุฃูู. ุฃููุงู ุจู ูู ูุธุงู ุงูุฌุงูุนุฉ.",
                    nursing: "ุชูุงูุงู ูุซู ุงุณุชูุจุงู ุงููุฑูุถุ ูุฑุญุจ ุจู ุจุญุฑุงุฑุฉ. ุฑุญูุชู ูุญู ุงูุนุทุงุก ุชุจุฏุฃ ุงูุขู.",
                    health_sciences: "ุงูุนููุฉ ุงูุฃููู ูู ุณุคุงู ุงูุฏุฎูู! ุญููู ุจุนูุงูุฉ ูุชูุดู ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ.",
                    sciences: "ูุฑุญุจุงู ุฃููุง ุงูุจุงุญุซ! ูู ุงูุชุดุงู ุนุธูู ูุจุฏุฃ ุจูุฑุถูุฉ. ูุง ูู ูุฑุถูุชู ููุฅุฌุงุจุฉ ุงูุตุญูุญุฉุ",
                    arts: "ููู ูุตุฉ ุจุฏุงูุฉุ ููุฐู ุจุฏุงูุฉ ูุตุชู ุงูุฌุงูุนูุฉ. ุงุฌุนููุง ุจุฏุงูุฉ ูููููุฉ.",
                    law: "ูุจู ุงูุฏุฎููุ ูุฌุจ ุงูุชุฃูุฏ ูู ุงุณุชููุงุก ุงูุดุฑูุท. ูู ุฃูุช ูุณุชุนุฏ ูุฅุซุจุงุช ุฌุฏุงุฑุชูุ",
                    religion: "ุจุณู ุงููู ูุจุฏุฃ. ูุฐู ุงูุจูุงุจุฉ ูู ูุฏุฎูู ุฅูู ุตุฑุญ ูู ุตุฑูุญ ุงูุนูู ูุงูุฅููุงู.",
                    education: "ุฃููุงู ุจู ูู ุงููุตู ุงูุฃูู ูู ุฑุญูุชู. ูู ุฅุฌุงุจุฉ ุตุญูุญุฉ ูู ุฎุทูุฉ ูุญู ุฅููุงู ุงูุขุฎุฑูู.",
                    economics: "ูุฐู ุฃูู ุตููุฉ ูู! ุงุณุชุซูุฑ ุชุฑููุฒู ุฌูุฏุงู ูุชุญููู ุฃูู ุฑุจุญ ูู ุฑุตูุฏู."
                },
                'library': {
                    medicine: "ุงูููุชุจุฉ ูู ูุตุฏุฑ ุงูุฃุจุญุงุซ ุงูุทุจูุฉ ุงูุญุฏูุซุฉ. ูู ูุชุงุจ ููุง ูุฏ ูููุฐ ุญูุงุฉ ูู ุงููุณุชูุจู.",
                    engineering: "ููุง ุชุฌุฏ ุงููุฎุทุทุงุช ูุงููุฑุงุฌุน ูุจูุงุก ุฃู ุดูุก ุชุชุฎููู. ุงููุนุฑูุฉ ูู ุฃููู ููุงุฏ ุงูุจูุงุก.",
                    it: "ุงูููุชุจุฉ ูู ูุงุนุฏุฉ ุจูุงูุงุชูุง ุงูุถุฎูุฉ. ุงุจุญุซ ุฌูุฏุงู ูุณุชุฌุฏ ุงูุฎูุงุฑุฒููุฉ ุงูุตุญูุญุฉ ูุญู ุฃู ุชุญุฏู.",
                    nursing: "ููุง ูุญุชุงุฌ ูููุฑุงุฌุน ููุนุฑูุฉ ุฃูุถู ุทุฑู ุงูุฑุนุงูุฉุ ุณุชุฌุฏ ููุง ูู ูุง ุชุญุชุงุฌู ูุชุบุฐูุฉ ุนููู.",
                    health_sciences: "ูุชุงุฆุฌ ุฃุจุญุงุซูุง ุชุนุชูุฏ ุนูู ุฏูุฉ ูุตุงุฏุฑูุง. ุงูููุชุจุฉ ูู ูุฎุชุจุฑู ุงููุธุฑู ุงูุฃูู.",
                    sciences: "ููุง ุชุฌุฏ ุฃุจุญุงุซ ูู ุณุจูููุง. ูู ุนูู ุฃูุชุงู ุงูุนูุงููุฉ ูุชุฑู ุฃุจุนุฏ.",
                    arts: "ุงููุชุจ ูู ุบุฐุงุก ุงูุฑูุญ. ุงุณุชููู ูู ูุตุต ุงูุนุธูุงุก ููุง ูุชูุชุจ ูุตุชู ุงูุฎุงุตุฉ.",
                    law: "ููุง ุชุฌุฏ ูุตูุต ุงูููุงููู ูุงูุณูุงุจู ุงููุถุงุฆูุฉ. ูู ูุถูุฉ ูุงุฌุญุฉ ุชุจุฏุฃ ุจุจุญุซ ุฏููู.",
                    religion: "ูุฐู ุฑูุงุถ ูู ุฑูุงุถ ุงูุฌูุฉ. ููุง ูุชุจ ุงูุชูุณูุฑ ูุงูุญุฏูุซ ุงูุชู ุชููุฑ ุงูุนูู ูุงูููุจ.",
                    education: "ุงูููุชุจุฉ ูู ูุตุฏุฑ ุฅุนุฏุงุฏ ุงูุฏุฑูุณ ูููุณุชูุจู. ูููุง ูุฑุฃุช ุฃูุซุฑุ ุฒุงุฏุช ูุฏุฑุชู ุนูู ุงูุชุนููู.",
                    economics: "ููุง ุชุฌุฏ ูุธุฑูุงุช ูุจุงุฑ ุงูุงูุชุตุงุฏููู. ุฏุฑุงุณุฉ ุงููุงุถู ูู ุฃูุถู ุทุฑููุฉ ููุชูุจุค ุจุงููุณุชูุจู."
                },
                'faculties-list': {
                    medicine: "ุณุชุฌุฏ ูููุฉ ุงูุทุจ ููุงุ ุญูุซ ูุชุนูู ููู ูููุฐ ุงูุฃุฑูุงุญ. ุงุฎุชุฑ ุจุญููุฉ ูุดุบู.",
                    engineering: "ูุฐู ููุทูุฉ ุงููููุงุชุ ููููุชู (ุงูููุฏุณุฉ) ููุง! ูู ูุจูู ูุญูู ูุนุฑูุฉ ูุฎุชููุฉ. ุงุณุชูุดู ุจุดุบู.",
                    it: "ูุฐู ูู ุงูุดุจูุฉ ุงูุฑุฆูุณูุฉ ูููููุงุช. ูู ูููุฉ ุชูุซู ุฎุงุฏูุงู (Server) ูููุนุฑูุฉ. ุฅูู ุฃู ูุงุญุฏ ุณุชุชุตูุ",
                    nursing: "ููุง ุชุชูุฒุน ุฃูุณุงู ุงููุณุชุดูู ุงูุชุนูููู... ุนููุงูุ ุฃูุตุฏ ูููุงุช ุงูุฌุงูุนุฉ. ูู ูููุฉ ุชูุฏู ููุนุงู ูุฑูุฏุงู ูู ุงูุฑุนุงูุฉ.",
                    health_sciences: "ูู ูููุฉ ููุง ุชุฎุชุต ุจูุฌุงู ุญููู. ุงุณุชูุดููุง ูุชุฌุฏ ุงููุฌุงู ุงูุฐู ูุซูุฑ ุดุบูู.",
                    sciences: "ูุฐู ุงููููุงุช ุชูุซู ูุฑูุน ุดุฌุฑุฉ ุงููุนุฑูุฉ. ุฃู ูุฑุน ุณุชุฎุชุงุฑ ูุชุชุณูููุ",
                    arts: "ูู ูููุฉ ููุง ุชูุซู ูุตูุงู ูู ูุชุงุจ ุงูุฌุงูุนุฉ ุงููุจูุฑ. ุฃู ูุตู ุณุชุฎุชุงุฑ ุฃู ุชูุฑุฃุ",
                    law: "ุฃูุงูู ููุฆุงุช ุชุดุฑูุนูุฉ ูุฎุชููุฉ ูููุนุฑูุฉ. ุงุฎุชุฑ ุงูููุฆุฉ ุงูุชู ุณุชูุชูู ุฅูููุง.",
                    religion: "ูู ูููุฉ ููุง ูู ููุจุฑ ุนูู. ุงุฎุชุฑ ุงูููุจุฑ ุงูุฐู ุณุชููู ููู ุงูุนูู ุงูุดุฑุนู.",
                    education: "ูุฐู ูู ุงููุตูู ุงูุฏุฑุงุณูุฉ ููุฌุงูุนุฉ. ุงุฎุชุฑ ุงููุตู ุงูุฐู ุณุชุชุนูู ููู ููู ุชูุนูููู.",
                    economics: "ูุฐู ูู ุฃุณูุงู ุงููุนุฑูุฉ ุงููุฎุชููุฉ. ูู ูููุฉ ููุง ุฃุตูููุง ููููุชูุง. ุงุณุชุซูุฑ ูู ูุณุชูุจูู."
                },
                'studentaffairs-info': {
                    medicine: "ุตุญุฉ ุงูุทุงูุจ ุงูููุณูุฉ ูุงูุงุฌุชูุงุนูุฉ ุฌุฒุก ูุง ูุชุฌุฒุฃ ูู ูุฌุงุญู. ุดุคูู ุงูุทูุจุฉ ูู 'ุงูุทุจูุจ' ุงูุฐู ูุนุงูุฌ ุฃู ูุดููุฉ ุชูุงุฌูู.",
                    engineering: "ููุง ุชุญุชุงุฌ ุงููุดุงุฑูุน ุงููุจุฑู ุฅูู ุฅุฏุงุฑุฉ ูุฅุดุฑุงูุ ุชุญุชุงุฌ ุฑุญูุชู ุงูุฌุงูุนูุฉ ุฅูู ุฏุนู. ุดุคูู ุงูุทูุจุฉ ูู ุงูุฌูุฉ ุงููุดุฑูุฉ.",
                    it: "ุดุคูู ุงูุทูุจุฉ ูู 'ูุธุงู ุงูุฏุนู ุงูููู' ูู. ูููุง ูุงูุช ุงููุดููุฉุ ูุฏููู ุญู ุฃู ุชูุฌูู.",
                    nursing: "ููุง ุชุฌุฏ ุงูุฑุนุงูุฉ ูุงูุฏุนู. ุนูุงุฏุฉ ุดุคูู ุงูุทูุจุฉ ูู ููุจ ุงูุฌุงูุนุฉ ุงูุฐู ููุชู ุจูู ุทุงูุจ.",
                    health_sciences: "ุชุญููู ุงููุดููุงุช ุงูุทูุงุจูุฉ ูุฅูุฌุงุฏ ุญููู ููุง ูู ุชุฎุตุตูู. ูุง ุชุชุฑุฏุฏ ูู ุงุณุชุดุงุฑุชูู.",
                    sciences: "ูู ูุฏุฑุณูู 'ุงูุธูุงูุฑ' ุงูุทูุงุจูุฉ ููุถุนูู ุงูุญููู. ุงุณุชูุดู ุงูุฎุฏูุงุช ุงูุชู ููุฏููููุง ูู.",
                    arts: "ููุง ูุชู ูุณุฌ ูุตุต ุงููุฌุงุญ ุงูุทูุงุจูุฉ ูุฏุนู ุงูููุงูุจ. ุดุคูู ุงูุทูุจุฉ ูู ููุตุฉ ุฅุจุฏุงุนู.",
                    law: "ูู ูุถูููู ุญูููู ูุทุงูุจ ูููุฌูููู ููุงุฌุจุงุชู. ุชุนุฑู ุนูู 'ููุงููู' ุงูุฏุนู ุงูุทูุงุจู.",
                    religion: "ุงูุฅุฑุดุงุฏ ูุงูุชูุฌูู ุงูุณููู ูู ุฃูู ููุงูููุ ุงุณุชุนู ุจูู ูุชููู ุฑุญูุชู ูุจุงุฑูุฉ.",
                    education: "ูู 'ุงููุนูููู' ุงูุฐูู ูุฑุดุฏููู ุฎุงุฑุฌ ุงููุงุนุฉ ุงูุฏุฑุงุณูุฉุ ููุณุงุนุฏููู ุนูู ุชูููุฉ ููุงุฑุงุชู.",
                    economics: "ูุฏูุฑูู 'ูุญูุธุฉ' ุงูููุญ ูุงููุฑูุถ ููุณุงุนุฏุชู. ุงุณุชุซูุฑ ููุชู ูู ุงูุชุนุฑู ุนูู ุฎุฏูุงุชูู ุงููุงููุฉ."
                }
            };

            const gameData = {
                'gate': { id: 'gate_q1', image: 'hares 1.webp', question: 'ุฃููุงู ุจู ูู ุงูุฌุงูุนุฉ ุงูุฅุณูุงููุฉ! ููุฏุฎููุ ุฃุฌุจ ุนู ุงูุณุคุงู ุงูุชุงูู: ูู ุฃู ุนุงู ุชุฃุณุณุช ุงูุฌุงูุนุฉุ', options: { '1978': '1978', '1982': '1982', '1960': '1960', '1990': '1990' }, correctAnswer: '1978', points: 1, 
                    hint: { default: "ุงูุชุงุฑูุฎ ูุฑูุจ ูู ููุงูุฉ ุงูุณุจุนูููุงุช." },
                    correctFeedback: { default: 'ุฑุงุฆุน! ููุฏ ุญุตูุช ุนูู ุฌููู ูุงุญุฏ. ุงูุจูุงุจุฉ ุงูุขู ููุชูุญุฉ ุฃูุงูู!' },
                    incorrectFeedback: { default: 'ุฅุฌุงุจุฉ ุบูุฑ ุตุญูุญุฉ. ุญุงูู ูุฑุฉ ุฃุฎุฑู!' }
                },
                'library': [ { id: 'library_q1', image: 'library_question.webp', question: 'ุชุถู ููุชุจุชูุง ููุฒุงู ูุนุฑููุงู ุถุฎูุงู. ูู ุนุฏุฏ ุงููุฑุงุฌุน ุงูุฅููุชุฑูููุฉ ุงูุชู ุชููุฑูุงุ', options: { '100k': 'ุฃูุซุฑ ูู 100 ุฃูู ูุฑุฌุน ุงููุชุฑููู', '150k': 'ุฃูุซุฑ ูู 150 ุฃูู ูุฑุฌุน ุงููุชุฑููู', '50k': 'ุฃูู ูู 50 ุฃูู ูุฑุฌุน ุงููุชุฑููู', '200k': 'ุฃูุซุฑ ูู 200 ุฃูู ูุฑุฌุน ุงููุชุฑููู' }, correctAnswer: '150k', points: 1, 
                    hint: { it: "ููุงุนุฏ ุงูุจูุงูุงุช ูุฏููุง ูุงุณุนุฉ ุฌุฏุงูุ ููุฑ ูู ุฑูู ูุจูุฑ ูููู ููุณ ุงูุฃูุจุฑ ูู ุงูุฎูุงุฑุงุช." },
                    correctFeedback: { default: 'ุฅุฌุงุจุฉ ููุชุงุฒุฉ! ูุนุฑูุชู ุฏูููุฉ. ููุฏ ุฑุจุญุช ุฌููููุง ูุงุญุฏูุง.' },
                    incorrectFeedback: { default: 'ุงููุนุฑูุฉ ููุฉุ ุญุงูู ูุฑุฉ ุฃุฎุฑู!' } 
                }, { id: 'library_q2', image: 'library_question_2.webp', question: 'ูู ุชููุฑ ุงูููุชุจุฉ ูุงุนุงุช ูุงุฏุฆุฉ ููุฎุตุตุฉ ููุฏุฑุงุณุฉุ', options: { 'yes': 'ูุนูุ ุชููุฑ ูุงุนุงุช ูุงุฏุฆุฉ', 'no': 'ูุงุ ุงูููุชุจุฉ ูููุชุจ ููุท' }, correctAnswer: 'yes', points: 1, 
                    hint: { education: "ุจูุฆุฉ ุงูุชุนูู ุงูููุงุณุจุฉ ุถุฑูุฑูุฉุ ูุงูุฌุงูุนุฉ ุชูุชู ุจุฐูู." },
                    correctFeedback: { default: 'ุจุงูุชุฃููุฏ! ุฑุงุญุชู ุฃุซูุงุก ุงูุฏุฑุงุณุฉ ุชูููุง. ููุฏ ุฑุจุญุช ุฌููููุง ูุงุญุฏูุง ุฅุถุงูููุง.' },
                    incorrectFeedback: { default: 'ุฅุฌุงุจุฉ ุบูุฑ ุตุญูุญุฉ. ุงูููุชุจุฉ ููุงู ูุซุงูู ููุฏุฑุงุณุฉ.' } 
                }, { id: 'library_q3', image: 'library_question_3.webp', question: 'ููู ุชุณุงุนุฏู ุงูููุชุจุฉ ูู ุฃุจุญุงุซู ุงูุฌุงูุนูุฉุ', options: { 'resources': 'ุชููุฑ ูุตุงุฏุฑ ููุฑุงุฌุน ูุชููุนุฉ', 'writes_for_you': 'ุชูุชุจ ุงูุจุญุซ ุจุฏูุงู ุนูู' }, correctAnswer: 'resources', points: 1, 
                    hint: { sciences: "ุงูุจุญุซ ุงูุนููู ูุนุชูุฏ ุนูู ุงูุงุณุชุดูุงุฏ ุจูุตุงุฏุฑ ููุซููุฉ." },
                    correctFeedback: { default: 'ุตุญูุญ! ุงูููุชุจุฉ ูู ุดุฑููู ุงูุฃูู ูู ุงูุจุญุซ ุงูุนููู. ุฑุจุญุช ุฌููููุง ูุงุญุฏูุง.' },
                    incorrectFeedback: { default: 'ุฅุฌุงุจุฉ ุบูุฑ ุฏูููุฉ. ุงูููุชุจุฉ ุชุฏุนูู ุจุงููุตุงุฏุฑ ูุง ุจุงูููุงู ุจุงูุนูู ุนูู.' } 
                }, { id: 'library_q4', image: 'library_question_4.webp', question: 'ูู ุชููุฑ ุงูููุชุจุฉ ููุงุฏ ุฑูููุฉ ูููู ุงููุตูู ุฅูููุง ุนู ุจุนุฏุ', options: { 'yes_ebooks': 'ูุนูุ ุชููุฑ ูุชุจุงู ุฅููุชุฑูููุฉ', 'no_digital': 'ูุงุ ูู ุงูููุงุฏ ูุฑููุฉ ููุท' }, correctAnswer: 'yes_ebooks', points: 1, 
                    hint: { it: "ูุญู ูู ุนุตุฑ ุงูุชุญูู ุงูุฑูููุ ูุงูุฌุงูุนุฉ ุชูุงูุจ ุฐูู." },
                    correctFeedback: { default: 'ุฃุญุณูุช! ููููู ุงููุตูู ูููุฒ ูุนุฑูู ูู ุฃู ููุงู. ููุฏ ุฑุจุญุช ุขุฎุฑ ุฌููู ูู ูุฐู ุงููุฑุญูุฉ.' },
                    incorrectFeedback: { default: 'ุฅุฌุงุจุฉ ุบูุฑ ุตุญูุญุฉ. ุงูุนุตุฑ ุงูุฑููู ูู ููุจ ููุชุจุชูุง.' } 
                } ],
                'faculties-list': { isInfoScreen: true, nextScene: 'faculties' },
                'faculties': { image: 'first_faculties_q.webp', question: 'ุงุฎุชุฑ ููุน ุงูุชุญุฏู ุงูุฐู ุชูุฏ ุฎูุถู ููุง:', options: { 'tf_questions': '<span class="icon">โ๏ธโ</span> ุฃุณุฆูุฉ ุตุญ ูุฎุทุฃ', 'mc_questions': '<span class="icon">โ</span> ุฃุณุฆูุฉ ุงุฎุชูุงุฑ ูู ูุชุนุฏุฏ' }, correctAnswer: null, points: 0, nextScene: { 'tf_questions': 'tf_questions', 'mc_questions': 'mc_questions' } },
                'tf_questions': [ { id: 'tf_q1', image: 'all_q.webp', question: 'ุชุฃุณุณุช ุงูุฌุงูุนุฉ ุงูุฅุณูุงููุฉ ุจุบุฒุฉ ุนุงู 1978.', options: { 'correct': 'ุตุญ', 'incorrect': 'ุฎุทุฃ' }, correctAnswer: 'correct', points: 1, hint:{default: "ูุฐุง ุงูุณุคุงู ูุดุจู ุณุคุงู ุงูุจูุงุจุฉุ ูู ุชุชุฐูุฑูุ"} }, { id: 'tf_q2', image: 'all_q.webp', question: 'ุงูุฌุงูุนุฉ ูุฏููุง 11 ูููุฉ.', options: { 'correct': 'ุตุญ', 'incorrect': 'ุฎุทุฃ' }, correctAnswer: 'correct', points: 1, hint:{default: "ุนุฏุฏ ุงููููุงุช ูุจูุฑ ููุถู ุชุฎุตุตุงุช ูุชููุนุฉ."} }, { id: 'tf_q3', image: 'all_q.webp', question: 'ูููุฉ ุงูุทุจ ุชุฃุณุณุช ุนุงู 2006.', options: { 'correct': 'ุตุญ', 'incorrect': 'ุฎุทุฃ' }, correctAnswer: 'correct', points: 1, hint:{medicine: "ุชุงุฑูุฎ ุชุฃุณูุณ ูููุชู ุญุฏูุซ ูุณุจูุงู."} } ],
                'mc_questions': [ { id: 'mc_q1', image: 'all_q.webp', question: 'ูู ุนุฏุฏ ุงููููุงุช ูู ุงูุฌุงูุนุฉ ุงูุฅุณูุงููุฉ ุจุบุฒุฉุ', options: { '11': '11', '9': '9', '10': '10', '12': '12' }, correctAnswer: '11', points: 1, hint:{default: "ุงูุฑูู ูุฑุฏู ูุฃูุจุฑ ูู 10."} }, { id: 'mc_q2', image: 'all_q.webp', question: 'ุฃู ูู ุงููููุงุช ุงูุชุงููุฉ ููุณุช ูู ูููุงุช ุงูุฌุงูุนุฉุ', options: { 'it': 'ุชูููููุฌูุง ุงููุนูููุงุช', 'ุงููููู': 'ุงููููู', 'ุงูุทุจ': 'ุงูุทุจ', 'ุงูููุฏุณุฉ': 'ุงูููุฏุณุฉ' }, correctAnswer: 'ุงููููู', points: 1, hint:{arts: "ูููุชู ูู 'ุงูุขุฏุงุจ'ุ ูููุณุช ุงููููู ุงูุฌูููุฉ."} }, { id: 'mc_q3', image: 'all_q.webp', question: 'ูุชู ุชุฃุณุณุช ูููุฉ ุงูุทุจ ุจุงูุฌุงูุนุฉุ', options: { '2006': '2006', '1980': '1980', '1993': '1993', '2005': '2005' }, correctAnswer: '2006', points: 1, hint:{default: "ูุงู ุฐูู ูู ููุชุตู ุงูุนูุฏ ุงูุฃูู ูู ุงูุฃูููุฉ ุงูุฌุฏูุฏุฉ."} } ],
                'exchange-info': { isInfoScreen: true, nextScene: 'exchange' },
                'exchange': { image: 'all_q.webp', question: 'ุงุฎุชุฑ ููุน ุงูุชุญุฏู ุงูุฐู ุชูุฏ ุฎูุถู ููุง:', options: { 'exchange_tf_questions': '<span class="icon">โ๏ธโ</span> ุฃุณุฆูุฉ ุตุญ ูุฎุทุฃ', 'exchange_mc_questions': '<span class="icon">โ</span> ุฃุณุฆูุฉ ุงุฎุชูุงุฑ ูู ูุชุนุฏุฏ' }, correctAnswer: null, points: 0, nextScene: { 'exchange_tf_questions': 'exchange_tf_questions', 'exchange_mc_questions': 'exchange_mc_questions' } },
                'exchange_tf_questions': [ { id: 'ex_tf_q1', image: 'all_q.webp', question: 'ุชูุชู ุงูุนูุงูุงุช ุงูุฎุงุฑุฌูุฉ ูู ุงูุฌุงูุนุฉ ุจุชูููุฑ ููุญ ุจูุงููุฑููุณุ ูุงุฌุณุชูุฑุ ุฏูุชูุฑุงู ููุง ุจุนุฏ ุงูุฏูุชูุฑุงู ูู ุฌุงูุนุงุช ุนุงูููุฉ.', options: { 'correct': 'ุตุญ', 'incorrect': 'ุฎุทุฃ' }, correctAnswer: 'correct', points: 1, hint:{default:"ูู ุชูุฏู ุงูุฌุงูุนุฉ ูุฑุจุท ุทูุงุจูุง ุจุงูุนุงููุ"} } ],
                'exchange_mc_questions': [ { id: 'ex_mc_q1', image: 'all_q.webp', question: 'ุฃูุงู ูู ุงูุฎุฏูุงุช ุงูุชุงููุฉ ุชุชูููุงูุง ุฏุงุฆุฑุฉ ุงูุนูุงูุงุช ุงูุฎุงุฑุฌูุฉุ', options: { 'ุชูููุฑ ููุญ ุฏุฑุงุณูุฉ ุฏูููุฉ ูุงูุชุจุงุฏู ุงูุฃูุงุฏููู ูุงุณุชูุทุงุจ ุงูุจุงุญุซูู': 'ุชูููุฑ ููุญ ุฏุฑุงุณูุฉ ุฏูููุฉ ูุงูุชุจุงุฏู ุงูุฃูุงุฏููู ูุงุณุชูุทุงุจ ุงูุจุงุญุซูู', 'ุชุฃููู ุงูููุญ ุงูุฏุฑุงุณูุฉ ููุท': 'ุชุฃููู ุงูููุญ ุงูุฏุฑุงุณูุฉ ููุท', 'ุชูุธูู ุงูุฑุญูุงุช ุงูุณูุงุญูุฉ': 'ุชูุธูู ุงูุฑุญูุงุช ุงูุณูุงุญูุฉ', 'ุฅุตุฏุงุฑ ุงูุชุฑุงุฎูุต ุงูุญููููุฉ': 'ุฅุตุฏุงุฑ ุงูุชุฑุงุฎูุต ุงูุญููููุฉ' }, correctAnswer: 'ุชูููุฑ ููุญ ุฏุฑุงุณูุฉ ุฏูููุฉ ูุงูุชุจุงุฏู ุงูุฃูุงุฏููู ูุงุณุชูุทุงุจ ุงูุจุงุญุซูู', points: 1, hint:{default: "ุงุจุญุซ ุนู ุงูุฅุฌุงุจุฉ ุงูุฃูุซุฑ ุดูููุงู ูุชุฎุตุตุงู."} } ],
                'grants-info': { isInfoScreen: true, nextScene: 'grants' },
                'grants': [ { id: 'grants_q1', image: 'all_q.webp', question: 'ุฃููุช ูุฑูู ูุตููุง ุงูุฏุฑุงุณู ุงูุฃูู ูู ูููุฉ ุงูููุฏุณุฉ ุจุชูููุ ูุญุตูุช ุนูู ูุนุฏู ูุตูู 96% ุจุนุฏ ุฃู ุฏุฑุณุช 16 ุณุงุนุฉ ูุนุชูุฏุฉ. ูุง ูู ูุณุจุฉ "ููุญุฉ ุงูุงูุชูุงุฒ" ุงูุชู ุชุณุชุญููุง ุชููุงุฆูุงู ูู ุงููุตู ุงูุชุงููุ', options: { '35': '35%', '50': '50%', '70': '70%', '100': '100%' }, correctAnswer: '70', points: 1, hint:{economics:"ุงูุชููุฒ ุงูุนุงูู ููุงูุฃ ุจุฃุนูู ูุณุจุฉ ููุญุฉ ุชููู ูุชุงุญุฉ."} } ],
                'admission-info': { isInfoScreen: true, nextScene: 'admission' },
                'admission': { image: 'all_q.webp', question: 'ุงุฎุชุฑ ููุน ุงูุชุญุฏู ุงูุฐู ุชูุฏ ุฎูุถู ููุง:', options: { 'admission_tf_questions': '<span class="icon">โ๏ธโ</span> ุฃุณุฆูุฉ ุตุญ ูุฎุทุฃ', 'admission_mc_questions': '<span class="icon">โ</span> ุฃุณุฆูุฉ ุงุฎุชูุงุฑ ูู ูุชุนุฏุฏ' }, correctAnswer: null, points: 0, nextScene: { 'admission_tf_questions': 'admission_tf_questions', 'admission_mc_questions': 'admission_mc_questions' } },
                'admission_tf_questions': [ { id: 'ad_tf_q1', image: 'all_q.webp', question: 'ูุนุฏู ุงููุจูู ูู ูููุฉ ุงูุทุจ ุงูุจุดุฑู ูู 96%.', options: { 'correct': 'ุตุญ', 'incorrect': 'ุฎุทุฃ' }, correctAnswer: 'incorrect', points: 1, hint:{medicine: "ุงููุจูู ูู ูููุชู ูุชุทูุจ ุฃุนูู ูุนุฏู ุนูู ุงูุฅุทูุงูุ ููู ุฃุนูู ูู ูุฐุง ุงูุฑูู."} } ],
                'admission_mc_questions': [ { id: 'ad_mc_q1', image: 'all_q.webp', question: 'ูุง ูู ูุนุฏู ุงููุจูู ุงููุทููุจ ููุงูุชุญุงู ุจุชุฎุตุต "ุงูุฐูุงุก ุงูุงุตุทูุงุนู"ุ', options: { '80': '80%', '65': '65%', '70': '70%', '75': '75%' }, correctAnswer: '80', points: 1, hint:{it:"ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ุชุฎุตุต ููุฏุณูุ ููุนุฏูุงุช ุงูููุฏุณุฉ ุชุจุฏุฃ ูู ูุฐุง ุงูุฑูู."} } ],
                'studentaffairs-info': { isInfoScreen: true, nextScene: 'studentaffairs' },
                'studentaffairs': { image: 'all_q.webp', question: 'ุฃูุช ุงูุขู ูู ูุญุทุฉ ุดุคูู ุงูุทูุจุฉุ ุงุฎุชุฑ ููุน ุงูุชุญุฏู:', options: { 'studentaffairs_tf_questions': '<span class="icon">โ๏ธโ</span> ุฃุณุฆูุฉ ุตุญ ูุฎุทุฃ', 'studentaffairs_mc_questions': '<span class="icon">โ</span> ุฃุณุฆูุฉ ุงุฎุชูุงุฑ ูู ูุชุนุฏุฏ' }, correctAnswer: null, points: 0, nextScene: { 'studentaffairs_tf_questions': 'studentaffairs_tf_questions', 'studentaffairs_mc_questions': 'studentaffairs_mc_questions' } },
                'studentaffairs_tf_questions': [
                    { id: 'sa_tf_q1', image: 'all_q.webp', question: 'ุชุฃุณุณุช ุนูุงุฏุฉ ุดุคูู ุงูุทูุจุฉ ูู ููุณ ุนุงู ุชุฃุณูุณ ุงูุฌุงูุนุฉ.', options: { 'correct': 'ุตุญ', 'incorrect': 'ุฎุทุฃ' }, correctAnswer: 'incorrect', points: 1, hint: { default: 'ุงูุฌุงูุนุฉ ุชุฃุณุณุช ุนุงู 1978ุ ููู ุงูุนูุงุฏุฉ ุชุฃุณุณุช ุจุนุฏ ุฐูู ุจุจุถุน ุณููุงุช ููููุฉ.' }, correctFeedback: { default: 'ุฅุฌุงุจุฉ ุตุญูุญุฉ! ุชุฃุณุณุช ุงูุนูุงุฏุฉ ุนุงู 1981ู.' } },
                    { id: 'sa_tf_q2', image: 'all_q.webp', question: 'ูู ููุงู ุนูุงุฏุฉ ุดุคูู ุงูุทูุจุฉ ุงูุฅุดุฑุงู ุนูู ุงููุดุงุท ุงูุซูุงูู ูุงูุฑูุงุถู.', options: { 'correct': 'ุตุญ', 'incorrect': 'ุฎุทุฃ' }, correctAnswer: 'correct', points: 1, hint: { default: 'ุงูุฃูุดุทุฉ ุงููุงูููุฌูุฉ ูู ุฌุฒุก ุฃุณุงุณู ูู ุนูู ุงูุนูุงุฏุฉ.' } },
                    { id: 'sa_tf_q3', image: 'all_q.webp', question: 'ูุณู ุงูุจุญุซ ุงูุงุฌุชูุงุนู ูู ุงููุณุคูู ุนู ุชุฑุดูุญ ุงูุทูุจุฉ ููููุญ ุงูุฎุงุฑุฌูุฉ.', options: { 'correct': 'ุตุญ', 'incorrect': 'ุฎุทุฃ' }, correctAnswer: 'correct', points: 1, hint: { economics: 'ุงูุญุงูุฉ ุงููุงุฏูุฉ ููุทุงูุจ ุนุงูู ููู ูู ุชุญุฏูุฏ ุงุณุชุญูุงูู ููููุญุ ููุฐุง ุงููุณู ูุฏุฑุณ ุฐูู.' } },
                    { id: 'sa_tf_q4', image: 'all_q.webp', question: 'ุงูุนูู ุงูุชุทูุนู ูู ูุณุงู ุงุฎุชูุงุฑู ูููู ููุทุงูุจ ุงูุชุณุฌูู ููู.', options: { 'correct': 'ุตุญ', 'incorrect': 'ุฎุทุฃ' }, correctAnswer: 'correct', points: 1, hint: { education: 'ุชุดุฌุน ุงูุฌุงูุนุฉ ุนูู ุฎุฏูุฉ ุงููุฌุชูุนุ ูุงูุนูู ุงูุชุทูุนู ูู ุฃุญุฏ ุฃุดูุงู ูุฐู ุงูุฎุฏูุฉ.' } }
                ],
                'studentaffairs_mc_questions': [
                    { id: 'sa_mc_q1', image: 'all_q.webp', question: 'ูู ุฃู ุนุงู ุฃูุดุฆุช ุนูุงุฏุฉ ุดุคูู ุงูุทูุจุฉุ', options: { '1978': '1978ู', '1981': '1981ู', '1990': '1990ู', '2000': '2000ู' }, correctAnswer: '1981', points: 1, hint: { default: 'ูุงู ุฐูู ุจุนุฏ 3 ุณููุงุช ูู ุชุฃุณูุณ ุงูุฌุงูุนุฉ.' } },
                    { id: 'sa_mc_q2', image: 'all_q.webp', question: 'ุฃู ูู ุงูุฃูุณุงู ุงูุชุงููุฉ ูุง ูุชุจุน ูุนูุงุฏุฉ ุดุคูู ุงูุทูุจุฉุ', options: { 'research': 'ุงูุจุญุซ ุงูุงุฌุชูุงุนู', 'sports': 'ุงููุดุงุท ุงูุฑูุงุถู', 'guidance': 'ุงูุชูุฌูู ูุงูุฅุฑุดุงุฏ', 'admission': 'ุงููุจูู ูุงูุชุณุฌูู' }, correctAnswer: 'admission', points: 1, hint: { default: 'ุงููุจูู ูุงูุชุณุฌูู ูู ุนูุงุฏุฉ ูุณุชููุฉ ููุฎุชุตุฉ.' } },
                    { id: 'sa_mc_q3', image: 'all_q.webp', question: 'ูุง ูู ุงููุฏู ูู ูุณู ุงูุจุญุซ ุงูุงุฌุชูุงุนู ุจุดูู ุฃุณุงุณูุ', options: { 'academic': 'ูุณุงุนุฏุฉ ุงูุทูุจุฉ ุฃูุงุฏูููุงู', 'financial': 'ูุณุงุนุฏุฉ ุงูุทูุจุฉ ูุงููุงู', 'sports': 'ุชูุธูู ุงููุฑู ุงูุฑูุงุถูุฉ', 'cultural': 'ุฅูุงูุฉ ุงููุฏูุงุช ุงูุซูุงููุฉ' }, correctAnswer: 'financial', points: 1, hint: { economics: 'ูุฑูุฒ ุงููุณู ุนูู ุฏุฑุงุณุฉ ุงููุดููุงุช ุงูุงูุชุตุงุฏูุฉ ููุทูุจุฉ.' } },
                    { id: 'sa_mc_q4', image: 'all_q.webp', question: 'ูุง ูู ุฃูู ุฎุทูุฉ ูุฌุจ ุนูู ุงูุทุงูุจ ุงุชุจุงุนูุง ููุงุณุชูุงุฏุฉ ูู ุฎุฏูุงุช ุงูุจุญุซ ุงูุงุฌุชูุงุนูุ', options: { 'visit': 'ุฒูุงุฑุฉ ุงูุนูุงุฏุฉ ุดุฎุตูุงู', 'form': 'ุชุนุจุฆุฉ ุงุณุชูุงุฑุฉ ุฅููุชุฑูููุฉ', 'call': 'ุงูุงุชุตุงู ูุงุชููุงู ุจุงููุณู', 'email': 'ุฅุฑุณุงู ุจุฑูุฏ ุฅููุชุฑููู' }, correctAnswer: 'form', points: 1, hint: { it: 'ุชุจุฏุฃ ูุนุธู ุงููุนุงููุงุช ุงูุญุฏูุซุฉ ุจุฎุทูุฉ ุฑูููุฉ.' } }
                ],
                'cafeteria': { isUnderConstruction: true },
                'hospital': { isUnderConstruction: true },
                'conference': { isUnderConstruction: true },
                'stadium': { isUnderConstruction: true }
            };

            const admissionInfoData = [
                { faculty: "ุงูุทุจ", specializations: [ { name: "ุงูุทุจ ุงูุจุดุฑู", score: "97% ุนููู / 96% ุทูุงุจ" } ] },
                { faculty: "ุงูููุฏุณุฉ", specializations: [ { name: "ุงูููุฏุณุฉ ุงููุฏููุฉุ ุงูููุฏุณุฉ ุงููุนูุงุฑูุฉ (ุชุตููู ุฏุงุฎููุ ุชูููููุฌูุง ูุจุงููุ ุชุฎุทูุท ุนูุฑุงูู)ุ ุงูุฐูุงุก ุงูุงุตุทูุงุนูุ ููุฏุณุฉ ุงูุญุงุณูุจุ ุงูููุฏุณุฉ ุงูุตูุงุนูุฉุ ุงูููุฏุณุฉ ุงูููุฑุจุงุฆูุฉุ ุงูููุฏุณุฉ ุงูุจูุฆูุฉุ ุงูููุฏุณุฉ ุงููููุงููููุฉุ ููุฏุณุฉ ุงููุธู ุงูุฐููุฉ", score: "80% ุนููู" } ] },
                { faculty: "ุชูููููุฌูุง ุงููุนูููุงุช", specializations: [ { name: "ุนูู ุงูุญุงุณูุจุ ุชุทููุฑ ุงูุจุฑูุฌูุงุชุ ุชูููููุฌูุง ุงููุนูููุงุชุ ุญูุณุจุฉ ุงูููุจ (ุฌุฏูุฏ)", score: "65% ุนููู" }, { name: "ุงููุณุงุฆุท ุงููุชุนุฏุฏุฉ", score: "70% ุนููู / 65% ุฃุฏุจู" } ] },
                { faculty: "ุงูุนููู", specializations: [ { name: "ุงูููููุงุกุ ุงูุฑูุงุถูุงุชุ ุงูููุฒูุงุกุ ุงูุฃุญูุงุกุ ุนููู ุงูุฃุฑุถ ูุงูุจูุฆุฉุ ุงูููููุงุก ุงูุญูููุฉุ ุนููู ุงูุจุญุงุฑุ ุงูุฅูุชุงุฌ ุงููุจุงุชูุ ุงูุชูููููุฌูุง ุงูุญูููุฉุ ุฑูุงุถูุงุช ูุฑุนู ููุจููุชุฑ", score: "65% ุนููู" } ] },
                { faculty: "ุงูุนููู ุงูุตุญูุฉ", specializations: [ { name: "ุงูุนููู ุงูุทุจูุฉ ุงููุฎุจุฑูุฉุ ุงูุจุตุฑูุงุชุ ุงูุนูุงุฌ ุงูุทุจูุนูุ ุชูููุงุช ุงูุชุตููุฑ ุงูุทุจู (ุฌุฏูุฏ)ุ ุงูุชุบุฐูุฉ ุงูุณุฑูุฑูุฉ (ุฌุฏูุฏ)", score: "70% ุนููู" } ] },
                { faculty: "ุงูุชูุฑูุถ", specializations: [ { name: "ุงูุชูุฑูุถ", score: "70% ุนููู / 80% ุฃุฏุจู" }, { name: "ุงููุจุงูุฉ", score: "70% ุนููู / 80% ุฃุฏุจู" } ] },
                { faculty: "ุงูุงูุชุตุงุฏ ูุงูุนููู ุงูุฅุฏุงุฑูุฉ", specializations: [ { name: "ุงููุญุงุณุจุฉ (ุฏุฑุงุณุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ)ุ ุฅุฏุงุฑุฉ ุงูุฃุนูุงู (ุฏุฑุงุณุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ)", score: "65% ุนููู ูุฃุฏุจู" }, { name: "ุงููุญุงุณุจุฉ (ุฏุฑุงุณุฉ ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ)ุ ุฅุฏุงุฑุฉ ุงูุฃุนูุงู (ุฏุฑุงุณุฉ ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ)", score: "65% ุนููู ูุฃุฏุจู" }, { name: "ุฅุฏุงุฑุฉ ุงูุฃุนูุงู ูุฑุนู ุงูุฑูุงุฏุฉ ูุงูุฅุจุชูุงุฑ (ุฌุฏูุฏ)ุ ุงูุชุณููู ูุงูุชุฌุงุฑุฉ ุงูุงููุชุฑูููุฉุ ุงูุนููู ุงูุณูุงุณูุฉ ูุงูุฅุนูุงูุ ุงูุงูุชุตุงุฏ ูุงูุนููู ุงูุณูุงุณูุฉุ ุงูุงูุชุตุงุฏ ูุฑุนู ุงูุฅุญุตุงุก ุงูุชุทุจูููุ ุงูุนููู ุงููุงููุฉ ูุงููุตุฑููุฉุ ุงููุญุงุณุจุฉ ูุฑุนู ุชูููููุฌูุง ุงููุนูููุงุชุ ุงูุงูุชุตุงุฏ ุงูุฑููู ูุชูููููุฌูุง ุงููุงู", score: "65% ุนููู ูุฃุฏุจู" } ] },
                { faculty: "ุงูุดุฑูุนุฉ ูุงููุงููู", specializations: [ { name: "ุงูุดุฑูุนุฉ ุงูุฅุณูุงููุฉ", score: "65% ุนููู ูุฃุฏุจู" }, { name: "ุงูุดุฑูุนุฉ ุงูุฅุณูุงููุฉ ูุฑุนู ูุชูู ูุชุญููู", score: "75% ุนููู ูุฃุฏุจู" }, { name: "ุงูุดุฑูุนุฉ ูุงููุงููู", score: "75% ุนููู ูุฃุฏุจู" } ] },
                { faculty: "ุฃุตูู ุงูุฏูู", specializations: [ { name: "ุฃุตูู ุงูุฏูู (ุนุงู)ุ ุงูุฏุนูุฉ ูุงูุฅุนูุงู", score: "65% ุนููู ูุฃุฏุจู" } ] },
                { faculty: "ุงูุขุฏุงุจ", specializations: [ { name: "ุงููุบุฉ ุงูุนุฑุจูุฉุ ุงููุบุฉ ุงูุนุฑุจูุฉ ูุฑุนู ุงูุตุญุงูุฉุ ุงููุบุฉ ุงูุนุฑุจูุฉ ูุฑุนู ุงูุชุฏููู ุงููุบููุ ุงููุบุฉ ุงูุฅูุฌููุฒูุฉุ ูุบุฉ ุฅูุฌููุฒูุฉ ูุฑุนู ุชุฑุฌูุฉุ ูุบุฉ ุฅูุฌููุฒูุฉ ูุฑุนู ุตุญุงูุฉ ูุฅุนูุงู (ุฌุฏูุฏ)ุ ุงูุฌุบุฑุงููุงุ ุงูุฌุบุฑุงููุง ูุฑุนู ูุธู ุงููุนูููุงุช ุงูุฌุบุฑุงููุฉุ ุงูุตุญุงูุฉ ูุงูุฅุนูุงูุ ุงูุฅุนูุงู ุงูุฑูููุ ุงูุฎุฏูุฉ ุงูุงุฌุชูุงุนูุฉุ ุงูุชุงุฑูุฎ ูุงูุขุซุงุฑุ ุงูุชุงุฑูุฎ ูุฑุนู ุฏุฑุงุณุงุช ุฅุณุฑุงุฆูููุฉุ ุตุญุงูุฉ ูุฅุนูุงู ูุฑุนู ุชูููููุฌูุง ุงูุฅุฐุงุนุฉ ูุงูุชููุฒููู", score: "65% ุนููู ูุฃุฏุจู" } ] },
                { faculty: "ุงูุชุฑุจูุฉ", specializations: [ { name: "ุชุนููู ุงููุบุฉ ุงูุนุฑุจูุฉุ ุชุนููู ุงููุบุฉ ุงูุฅูุฌููุฒูุฉุ ุชุนููู ุงูุนูููุ ุชุนููู ุงูุฑูุงุถูุงุชุ ุชุนููู ุงุฌุชูุงุนูุงุชุ ุชุนููู ุงูุชุฑุจูุฉ ุงูุฅุณูุงููุฉุ ุงููุฑุญูุฉ ุงูุฃุณุงุณูุฉุ ุงูุฅุฑุดุงุฏ ุงูููุณู ูุงูุชูุฌูู ุงูุชุฑุจููุ ุงูููููุงุก ูุฃุณุงููุจ ุชุฏุฑูุณูุงุ ุงูููุฒูุงุก ูุฃุณุงููุจ ุชุฏุฑูุณูุงุ ุงูุฃุญูุงุก ูุฃุณุงููุจ ุชุฏุฑูุณูุงุ ุงูุญุงุณูุจ ูุฃุณุงููุจ ุชุฏุฑูุณูุ ุงููุบุฉ ุงูุนุฑุจูุฉ ูุฃุณุงููุจ ุชุฏุฑูุณูุงุ ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ ูุฃุณุงููุจ ุชุฏุฑูุณูุงุ ุงูุชุงุฑูุฎ ูุฃุณุงููุจ ุชุฏุฑูุณูุ ุงูุฌุบุฑุงููุง ูุฃุณุงููุจ ุชุฏุฑูุณูุ ุงูุฑูุงุถูุงุช ูุฃุณุงููุจ ุชุฏุฑูุณูุง", score: "65% ุนููู ูุฃุฏุจู" } ] }
            ];

            const gameState = { playerName: '', playerPhone: '', tawjihiYear: '', uniquePlayerId: null, score: 0, currentScene: null, currentSubQuestionIndex: 0, answeredQuestions: new Set(), selectedGuide: null };
            
            const sceneParentMap = {
                'tf_questions': 'faculties', 'mc_questions': 'faculties', 'exchange_tf_questions': 'exchange', 'exchange_mc_questions': 'exchange', 'admission_tf_questions': 'admission', 'admission_mc_questions': 'admission',
                'studentaffairs_tf_questions': 'studentaffairs', 'studentaffairs_mc_questions': 'studentaffairs'
            };
            
            const landingScreen = document.getElementById('landing-screen');
            const startScreen = document.getElementById('start-screen');
            const gameSceneContainer = document.getElementById('game-scene');
            const playerForm = document.getElementById('player-form');
            const playerNameDisplay = document.getElementById('player-name-display');
            const playerScoreDisplay = document.getElementById('player-score-display');
            const statusBar = document.getElementById('status-bar');
            const modal = document.getElementById('feedback-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalText = document.getElementById('modal-text');
            const modalCloseBtn = document.getElementById('modal-close-btn');
            const correctSound = document.getElementById('correct-sound');
            const incorrectSound = document.getElementById('incorrect-sound');
            const transitionSound = document.getElementById('transition-sound');
            const guideAppearsSound = document.getElementById('guide-appears-sound');
            const videoOverlay = document.getElementById('video-overlay');
            const welcomeVideo = document.getElementById('welcome-video');
            const skipVideoBtn = document.getElementById('skip-video-btn');
            const adModal = document.getElementById('ad-modal');
            let adShownThisSession = false; 
            let adTriggerQuestionIndex = -1; 
            let isAudioUnlocked = false;
            
            const preloadedImages = new Set();

            function preloadImage(url) {
                if (!url || preloadedImages.has(url)) {
                    return; // Skip if no URL or already preloaded
                }
                const img = new Image();
                img.src = url;
                preloadedImages.add(url);
                console.log(`Preloading: ${url}`);
            }

            function getUrlsForNextScenes(sceneId, questionIndex = 0) {
                const urls = new Set();
                if (sceneId === 'map') {
                    // Preload images for all destinations on the map
                    const mapButtons = document.querySelectorAll('#map-scene .option-btn');
                    mapButtons.forEach(btn => {
                        const dest = btn.dataset.destination;
                        if (gameData[dest]) {
                            const destData = Array.isArray(gameData[dest]) ? gameData[dest][0] : gameData[dest];
                            if(destData.image) urls.add(destData.image);
                        }
                    });
                } else {
                    const sceneData = gameData[sceneId];
                    if (Array.isArray(sceneData)) {
                        const nextIndex = questionIndex + 1;
                        if (nextIndex < sceneData.length) {
                            if(sceneData[nextIndex].image) urls.add(sceneData[nextIndex].image);
                        }
                    }
                }
                return Array.from(urls);
            }
            
            function preloadNextImages(sceneId, questionIndex = 0) {
                const urlsToLoad = getUrlsForNextScenes(sceneId, questionIndex);
                urlsToLoad.forEach(preloadImage);
            }

            async function unlockAudio() {
                if (isAudioUnlocked) return;
                const sounds = [correctSound, incorrectSound, transitionSound, guideAppearsSound];
                for (const sound of sounds) {
                    try {
                        await sound.play();
                        sound.pause();
                    } catch (error) {
                        console.warn("Audio unlock failed for one sound, this is expected.", error.name);
                    }
                }
                isAudioUnlocked = true;
                console.log("Audio context unlocked.");
            }

            function playSound(soundElement) {
                if (isAudioUnlocked && soundElement) {
                    soundElement.currentTime = 0;
                    soundElement.play().catch(error => {
                        console.error(`Could not play sound: ${soundElement.src}`, error);
                    });
                }
            }
            
            function showGuideModal(title, message) {
                 const guideInfo = allGuides.find(g => g.id === gameState.selectedGuide);
                 if (!guideInfo) return;
                 playSound(guideAppearsSound);

                 const modalContent = `
                     <div style="text-align: center;">
                         <div class="guide-icon" style="margin: 0 auto 10px; font-size: 48px; width: 80px; height: 80px;">${guideInfo.emoji}</div>
                         <h3 style="color: var(--primary-dark); margin: 0;">${guideInfo.name} ูููู:</h3>
                         <p style="font-size: 16px; color: var(--text-light); margin-top: 10px;">"${message}"</p>
                     </div>
                 `;
                 
                 showModal(title, modalContent, null);
            }
            
            function saveGameState() {
                try {
                    const stateToSave = { ...gameState, answeredQuestions: Array.from(gameState.answeredQuestions) };
                    localStorage.setItem('iugGameProgress', JSON.stringify(stateToSave));
                } catch (e) {
                    console.error("Failed to save game state:", e);
                }
            }

            function loadGameState() {
                try {
                    const savedStateJSON = localStorage.getItem('iugGameProgress');
                    if (savedStateJSON) {
                        const savedState = JSON.parse(savedStateJSON);
                        Object.assign(gameState, savedState);
                        gameState.answeredQuestions = new Set(savedState.answeredQuestions);
                        return true;
                    }
                    return false;
                } catch (e) {
                    console.error("Failed to load game state:", e);
                    return false;
                }
            }

            function resetGameState() {
                if (confirm("ูู ุฃูุช ูุชุฃูุฏ ุฃูู ุชุฑูุฏ ุจุฏุก ุฑุญูุฉ ุฌุฏูุฏุฉุ ุณูุชู ุญุฐู ูู ุชูุฏูู ุงูุญุงูู.")) {
                    localStorage.removeItem('iugGameProgress');
                    location.reload();
                }
            }

            function restoreGameSession() {
                if (loadGameState() && gameState.uniquePlayerId) {
                    landingScreen.classList.add('hidden');
                    startScreen.classList.add('hidden');
                    gameSceneContainer.classList.remove('hidden');
                    statusBar.classList.remove('hidden');

                    updatePlayerStats();

                    const sceneToRender = gameState.currentScene && gameData[gameState.currentScene] ? gameState.currentScene : 'map';
                    const indexToRender = gameState.currentSubQuestionIndex || 0;

                    showModal('ุฃููุงู ุจุนูุฏุชู!', `ูุฑุญุจุงู ${gameState.playerName}ุ ูุณุนุฏูุง ุฑุคูุชู ูุฌุฏุฏุงู! ุณูููู ูู ุญูุซ ุชููููุง.`, () => {
                        // This logic handles restoring to any possible scene, including new ones
                        const sceneMappings = {
                            'admission-info': renderAdmissionInfoScene,
                            'exchange-info': renderExchangeInfoScene,
                            'grants-info': renderGrantsInfoScene,
                            'faculties-list': renderFacultiesListScene,
                            'studentaffairs-info': renderStudentAffairsInfoScene
                        };

                        const parentScene = sceneParentMap[sceneToRender] || sceneToRender;

                        if (sceneMappings[parentScene]) {
                            sceneMappings[parentScene]();
                        } else if (gameData[parentScene] && gameData[parentScene].nextScene) {
                             renderScene(parentScene, indexToRender, false);
                        }
                        else if (sceneToRender) {
                            renderScene(sceneToRender, indexToRender, false);
                        } else {
                            renderScene('map', 0, false);
                        }
                    });
                    return true;
                }
                return false;
            }
            
            function startGame(event) {
                event.preventDefault();
                const nameInput = document.getElementById('name').value.trim();
                const phoneInput = document.getElementById('phone').value.trim();
                const tawjihiYearInput = document.getElementById('tawjihi-year').value.trim();
                const nameRegex = /^[\u0600-\u06FFa-zA-Z\s]+$/;
                if (nameInput.length < 5 || !nameRegex.test(nameInput)) {
                    showModal('ุชูุจูู ุจุฎุตูุต ุงูุงุณู', 'ูุฐุง ุงูุงุณู ุณูุชู ุงุณุชุฎุฏุงูู ูู ุงูุดูุงุฏุฉุ ุงูุฑุฌุงุก ูุชุงุจุชู ุจุดูู ุตุญูุญ (5 ุญุฑูู ุนูู ุงูุฃููุ ูุจุฏูู ุฃุฑูุงู ุฃู ุฑููุฒ).', null);
                    return;
                }
                const phoneRegex = /^05[9|6|4]\d{7}$/;
                if (!phoneRegex.test(phoneInput)) {
                    showModal('ุฎุทุฃ ูู ุฑูู ุงูุฌูุงู', 'ุงูุฑุฌุงุก ุฅุฏุฎุงู ุฑูู ุฌูุงู ุตุญูุญ ูุจุฏุฃ ุจู 059 ุฃู 056 ุฃู 054.', null);
                    return;
                }
                const currentYear = new Date().getFullYear();
                const tawjihiYear = parseInt(tawjihiYearInput);
                if (isNaN(tawjihiYear) || tawjihiYear < 2000 || tawjihiYear > currentYear + 1) {
                    showModal('ุฎุทุฃ ูู ุณูุฉ ุงูุชูุฌููู', 'ุงูุฑุฌุงุก ุฅุฏุฎุงู ุณูุฉ ุชูุฌููู ููุทููุฉ (ูุซุงู: 2024).', null);
                    return;
                }
                const startButton = event.target.querySelector('.action-button');
                startButton.disabled = true;
                startButton.textContent = 'ุฌุงุฑู ุงูุชุณุฌูู...';
                registerPlayer(nameInput, phoneInput, tawjihiYearInput)
                    .then(data => {
                        if (data.result === 'success' && data.uniqueId) {
                            gameState.playerName = nameInput;
                            gameState.playerPhone = phoneInput;
                            gameState.tawjihiYear = tawjihiYearInput;
                            gameState.uniquePlayerId = data.uniqueId;
                            saveGameState();
                            updatePlayerStats();
                            startScreen.classList.add('hidden');
                            document.getElementById('guide-selection-screen').classList.remove('hidden');
                        } else {
                            showModal('ุฎุทุฃ ูู ุงูุชุณุฌูู', 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุชุณุฌูู. ุงูุฑุฌุงุก ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.', null);
                            startButton.disabled = false;
                            startButton.textContent = 'ุงุจุฏุฃ ุงูุฑุญูุฉ!';
                        }
                    })
                    .catch(error => {
                        showModal('ุฎุทุฃ ูู ุงูุงุชุตุงู', 'ูุดู ุงูุงุชุตุงู ุจุงูุฎุงุฏู. ุงูุฑุฌุงุก ุงูุชุญูู ูู ุงุชุตุงูู ุจุงูุฅูุชุฑูุช.', null);
                        startButton.disabled = false;
                        startButton.textContent = 'ุงุจุฏุฃ ุงูุฑุญูุฉ!';
                    });
            }

            function showEndScene() {
                document.querySelectorAll('.game-stage').forEach(stage => stage.classList.add('hidden'));
                const endScene = document.getElementById('end-scene');
                const finalMessage = document.getElementById('final-message');
                finalMessage.textContent = `ุฃุญุณูุช ูุง ${gameState.playerName}! ููุฏ ุฃุชููุช ุฑุญูุชู ุจูุฌุงุญ ูุฃุธูุฑุช ูุนุฑูุฉ ููุชุงุฒุฉ ุจุงูุฌุงูุนุฉ ุงูุฅุณูุงููุฉ. ุฑุตูุฏู ุงูููุงุฆู ูู ${gameState.score} ุฌููููุงุ ูููููู ุงูุขู ุงูุญุตูู ุนูู ุดูุงุฏุฉ ุงููุดุงุฑูุฉ.`;
                endScene.classList.remove('hidden');
                if (gameState.uniquePlayerId) {
                    updatePlayerScore(gameState.uniquePlayerId, gameState.score);
                } else {
                    console.error("ุฎุทุฃ: ูุง ูููู ุชุญุฏูุซ ุงููุชูุฌุฉ ูุนุฏู ูุฌูุฏ ุฑูู ุชุนุฑููู.");
                }
            }

            function renderScene(sceneId, questionIndex = 0, pushState = true) {
                if (questionIndex === 0) {
                     const messageSceneId = sceneParentMap[sceneId] || sceneId;
                     setTimeout(() => showGuideModal('ุฑุณุงูุฉ ูู ูุฑุดุฏู', guideMessages[messageSceneId][gameState.selectedGuide]), 500);
                }
                playSound(transitionSound);
                
                if (pushState) history.pushState({ scene: sceneId, index: questionIndex }, '');
                
                document.querySelectorAll('.game-stage').forEach(stage => stage.classList.add('hidden'));

                if ((sceneId === 'tf_questions' || sceneId === 'mc_questions') && questionIndex === 0 && !adShownThisSession) {
                    const sceneData = gameData[sceneId];
                    if (sceneData.length > 3) {
                        const minTrigger = 1; 
                        const maxTrigger = Math.min(sceneData.length - 2, 4); 
                        adTriggerQuestionIndex = Math.floor(Math.random() * (maxTrigger - minTrigger + 1)) + minTrigger;
                    }
                }

                const sceneMappings = {
                    'map': () => document.getElementById('map-scene').classList.remove('hidden'),
                    'faculties-list': renderFacultiesListScene,
                    'grants-info': renderGrantsInfoScene,
                    'admission-info': renderAdmissionInfoScene,
                    'exchange-info': renderExchangeInfoScene,
                    'studentaffairs-info': renderStudentAffairsInfoScene,
                };

                if (sceneMappings[sceneId]) {
                    sceneMappings[sceneId]();
                    preloadNextImages(sceneId);
                    return;
                }

                const sceneElementId = `${sceneId}-scene`;
                const sceneElement = document.getElementById(sceneElementId);
                let sceneData = gameData[sceneId];

                if (!sceneData || !sceneElement) {
                    console.error(`Scene data or element not found for: ${sceneId}`);
                    showModal("ุฎุทุฃ", "ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุนุ ุณูุนูุฏู ููุฎุฑูุทุฉ.", () => renderScene('map'));
                    return;
                }

                gameState.currentScene = sceneId;
                if (Array.isArray(sceneData)) {
                    gameState.currentSubQuestionIndex = questionIndex;
                    sceneData = sceneData[questionIndex];
                } else {
                    gameState.currentSubQuestionIndex = 0;
                }
                saveGameState();

                let progressBarHTML = '';
                if (Array.isArray(gameData[sceneId])) {
                    const totalQuestions = gameData[sceneId].length;
                    const currentProgress = ((questionIndex + 1) / totalQuestions) * 100;
                    progressBarHTML = `<div class="progress-bar-container"><div class="progress-bar" style="width: ${currentProgress}%"></div></div>`;
                }
                
                let optionsHTML = '';
                let delay = 0;
                let optionKeys = Object.keys(sceneData.options);

                if (sceneData.correctAnswer !== null) optionKeys = shuffleArray(optionKeys);

                for (const key of optionKeys) {
                    optionsHTML += `<button class="option-btn" data-answer="${key}" style="animation-delay: ${delay}s">${sceneData.options[key]}</button>`;
                    delay += 0.1;
                }
                
                const helpButtonHTML = sceneData.correctAnswer !== null ? `<button id="guide-help-btn" class="guide-help-button">๐ก ูุณุงุนุฏุฉ ุงููุฑุดุฏ (-0.5 ุฌููู)</button>` : '';

                sceneElement.innerHTML = `<img src="${sceneData.image}" alt="ุตูุฑุฉ ูุดูุฏ ${sceneId}" class="scene-image" loading="lazy"><div class="scene-content">${progressBarHTML}<p class="scene-title">${sceneData.question}</p>${helpButtonHTML}<div class="options-container">${optionsHTML}</div></div>`;
                sceneElement.classList.remove('hidden');
                sceneElement.querySelector('.options-container').addEventListener('click', handleAnswer);
                
                if (sceneData.correctAnswer !== null) {
                    const helpBtn = document.getElementById('guide-help-btn');
                    if(helpBtn) helpBtn.addEventListener('click', useGuideHelp);
                }
            }

            function renderStudentAffairsInfoScene() {
                document.querySelectorAll('.game-stage').forEach(stage => stage.classList.add('hidden'));
                const sceneElement = document.getElementById('studentaffairs-info-scene');
                sceneElement.classList.remove('hidden');
                gameState.currentScene = 'studentaffairs-info';
                saveGameState();
                
                const container = document.getElementById('studentaffairs-info-container');
                container.innerHTML = `
                    <h3>ุนู ุงูุนูุงุฏุฉ</h3>
                    <p>ุชุนุฏ ุนูุงุฏุฉ ุดุคูู ุงูุทูุจุฉ ูู ุฃูู ุงูุนูุงุฏุงุช ุจุงูุฌุงูุนุฉ ุงููุฎุชุตุฉ ุจุงูุทูุจุฉุ ููู ุชุนูู ุจุชูุฏูู ุงูุฎุฏูุงุช ุงูุทูุงุจูุฉุ ูุงูุชู ุชุณูู ูู ุชูุธูู ุงูุฃูุดุทุฉ ุงููุงูููุฌูุฉ ูุงูุฃุนูุงู ุงูุชุทูุนูุฉุ ูุชุณุงุนุฏ ุงูุทุงูุจ ูู ุฅูุฌุงุฒ ุงููุนุงููุงุช ูุชุณููู ุนูููุฉ ุงูุชุณุฌูู ูุงูุชุณุฌูู ููููุญ ุงูุฏุงุฎููุฉ ูุงูุฎุงุฑุฌูุฉ ูุงููุฑูุถ ุงูุฌุงูุนูุฉ.</p>
                    <h3>ููุงู ุงูุนูุงุฏุฉ (ููุฐ 1981ู)</h3>
                    <ul>
                        <li>ุฏุฑุงุณุฉ ูุดููุงุช ุงูุทูุจุฉ ุงูุงูุชุตุงุฏูุฉ ููุถุน ุงูุญููู ููุง.</li>
                        <li>ุงูุฅุดุฑุงู ุนูู ุงููุดุงุท ุงูุซูุงููุ ุงูุงุฌุชูุงุนูุ ุงูุฑูุงุถู ูุงูููู.</li>
                        <li>ูุชุงุจุนุฉ ูุฌุงูุณ ุงูุทูุจุฉ ูุฅุฑุดุงุฏูู.</li>
                        <li>ุงููุธุฑ ูู ูุดููุงุช ุงูุทูุจุฉ ุงูููููุฉ ุงูุนุงูุฉ ูุงูุฎุงุตุฉ.</li>
                        <li>ุงูุฅุดุฑุงู ุนูู ุญุณู ุงุณุชุฎุฏุงู ูุฑุงูู ุงูุฌุงูุนุฉ.</li>
                        <li>ูุฑุงูุจุฉ ุงูุชุธุงู ุงูุฏุฑุงุณุฉ ูุจุญุซ ุธุงูุฑุฉ ุงูุชุบูุจ.</li>
                    </ul>
                    <h3>ุฃูุณุงู ุงูุนูุงุฏุฉ</h3>
                    <ul>
                        <li>ุงูุจุญุซ ุงูุงุฌุชูุงุนู "ุฎุฏูุงุช ุงูุทูุจุฉ"</li>
                        <li>ุงูุฃูุดุทุฉ ุงููุงูููุฌูุฉ ูุงูุนูู ุงูุชุทูุนู</li>
                        <li>ุงูุชูุฌูู ูุงูุฅุฑุดุงุฏ</li>
                        <li>ุงูุงุดุฑุงู ุนูู ูุฌุงูุณ ุงูุทูุจุฉ</li>
                        <li>ุงููุดุงุท ุงูุฑูุงุถู</li>
                    </ul>
                `;
                document.getElementById('start-studentaffairs-quiz-btn').onclick = () => renderScene('studentaffairs');
            }

            function renderAdmissionInfoScene() {
                document.querySelectorAll('.game-stage').forEach(stage => stage.classList.add('hidden'));
                const sceneElement = document.getElementById('admission-info-scene');
                sceneElement.classList.remove('hidden');
                gameState.currentScene = 'admission-info';
                saveGameState();
                const container = document.getElementById('admission-info-container');
                container.innerHTML = ''; 
                admissionInfoData.forEach(facultyData => {
                    const card = document.createElement('div');
                    card.className = 'admission-card';
                    let specializationsHTML = '<ul>';
                    facultyData.specializations.forEach(spec => {
                        const isNew = spec.name.includes('(ุฌุฏูุฏ)');
                        specializationsHTML += `<li><span class="specialization">${spec.name.replace(' (ุฌุฏูุฏ)', '')} ${isNew ? '<span class="score new-major">ุฌุฏูุฏ</span>' : ''}</span><span class="score">${spec.score}</span></li>`;
                    });
                    specializationsHTML += '</ul>';
                    card.innerHTML = `<h3>${facultyData.faculty}</h3>${specializationsHTML}`;
                    container.appendChild(card);
                });
                document.getElementById('start-admission-quiz-btn').onclick = () => renderScene('admission');
            }

            function renderGrantsInfoScene() {
                 document.querySelectorAll('.game-stage').forEach(stage => stage.classList.add('hidden'));
                 document.getElementById('grants-info-scene').classList.remove('hidden');
                 gameState.currentScene = 'grants-info';
                 saveGameState();
                 document.getElementById('start-grants-quiz-btn').onclick = () => renderScene('grants');
            }
            
            function renderExchangeInfoScene() {
                 document.querySelectorAll('.game-stage').forEach(stage => stage.classList.add('hidden'));
                 document.getElementById('exchange-info-scene').classList.remove('hidden');
                 gameState.currentScene = 'exchange-info';
                 saveGameState();
                 document.getElementById('start-exchange-quiz-btn').onclick = () => renderScene('exchange');
            }

            function handleAnswer(event) {
                const targetButton = event.target.closest('.option-btn');
                if (!targetButton || targetButton.disabled) return;

                const sceneId = gameState.currentScene;
                let sceneData = gameData[sceneId];
                let questionId;

                if (Array.isArray(sceneData)) {
                    sceneData = sceneData[gameState.currentSubQuestionIndex];
                    questionId = sceneData.id;
                } else {
                    questionId = sceneData.id || sceneId;
                }
                
                const selectedAnswer = targetButton.dataset.answer;
                
                if (sceneData.nextScene && sceneData.nextScene[selectedAnswer]) {
                    renderScene(sceneData.nextScene[selectedAnswer]);
                    return;
                }

                const allOptionButtons = document.querySelectorAll(`#${sceneId}-scene .option-btn`);
                allOptionButtons.forEach(btn => btn.disabled = true);

                const isCorrect = selectedAnswer === sceneData.correctAnswer;
                
                if (isCorrect) {
                    playSound(correctSound);

                    if (!gameState.answeredQuestions.has(questionId)) {
                        gameState.score += sceneData.points;
                        gameState.answeredQuestions.add(questionId);
                        saveGameState();
                        updatePlayerStats();
                        if (gameState.uniquePlayerId) {
                            updatePlayerScore(gameState.uniquePlayerId, gameState.score);
                        }
                    }
                    
                    targetButton.classList.add('correct');
                    let feedback = (sceneData.correctFeedback && (sceneData.correctFeedback[gameState.selectedGuide] || sceneData.correctFeedback.default)) || 'ุฅุฌุงุจุฉ ุตุญูุญุฉ!';
                    showGuideModal("ุฅุฌุงุจุฉ ุตุญูุญุฉ!", feedback);

                    if ((sceneId.includes('tf_questions') || sceneId.includes('mc_questions')) && !adShownThisSession) {
                        if (gameState.currentSubQuestionIndex === adTriggerQuestionIndex) {
                            setTimeout(showAdModal, 1000);
                        }
                    }

                    setTimeout(() => {
                        modal.classList.add('hidden'); // Close guide modal before transition
                        if (sceneId === 'gate') {
                            playWelcomeVideo();
                            preloadNextImages('map'); // Preload for the next step (map)
                        } else if (Array.isArray(gameData[sceneId])) {
                            const nextQuestionIndex = gameState.currentSubQuestionIndex + 1;
                            if (nextQuestionIndex < gameData[sceneId].length) {
                                preloadNextImages(sceneId, nextQuestionIndex); // Preload next question image
                                renderScene(sceneId, nextQuestionIndex);
                            } else {
                                const parentScene = sceneParentMap[sceneId];
                                if (parentScene) {
                                    const siblingScenes = Object.values(gameData[parentScene].nextScene);
                                    const allSiblingsCompleted = siblingScenes.every(siblingId => isStageCompleted(siblingId));
                                    if (allSiblingsCompleted) {
                                        showModal("ุฅูุฌุงุฒ ูุฐูู!", `ููุฏ ุฃูููุช ูู ุชุญุฏูุงุช ูุฐุง ุงููุณู ุจูุฌุงุญ. ููุนุฏ ุฅูู ุงูุฎุฑูุทุฉ.`, () => renderScene('map'));
                                    } else {
                                        showModal("ุฑุงุฆุน!", `ููุฏ ุฃุชููุช ูุฐุง ุงูุชุญุฏู. ููููู ุงูุขู ุชุฌุฑุจุฉ ุงูููุน ุงูุขุฎุฑ ูู ุงูุฃุณุฆูุฉ ุฃู ุงูุนูุฏุฉ ููุฎุฑูุทุฉ.`, () => renderScene(parentScene));
                                    }
                                } else {
                                    showModal("ุฅูุฌุงุฒ ุฑุงุฆุน!", `ููุฏ ุฃูููุช ุฌููุน ุชุญุฏูุงุช ูุฐุง ุงููุณู ุจูุฌุงุญ. ููุนุฏ ุฅูู ุงูุฎุฑูุทุฉ.`, () => renderScene('map'));
                                }
                            }
                        } else {
                            renderScene('map');
                        }
                    }, 2500);

                } else {
                    playSound(incorrectSound);
                    targetButton.classList.add('incorrect');
                    let feedback = (sceneData.incorrectFeedback && (sceneData.incorrectFeedback[gameState.selectedGuide] || sceneData.incorrectFeedback.default)) || 'ุฅุฌุงุจุฉ ุบูุฑ ุตุญูุญุฉ. ุญุงูู ูุฑุฉ ุฃุฎุฑู!';
                    showGuideModal("ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ", feedback);

                    setTimeout(() => {
                        targetButton.disabled = false;
                        allOptionButtons.forEach(btn => btn.disabled = false);
                        targetButton.classList.remove('incorrect');
                        modal.classList.add('hidden');
                    }, 2000);
                }
            }

            function useGuideHelp() {
                const helpBtn = document.getElementById('guide-help-btn');
                if (!helpBtn || helpBtn.disabled) return;

                if (gameState.score < 0.5) {
                    showModal("ุฑุตูุฏ ุบูุฑ ูุงูู", "ุนุฐุฑุงูุ ูุง ุชููู ูุตู ุฌููู ูุงุณุชุฎุฏุงู ุงููุณุงุนุฏุฉ.", null);
                    return;
                }

                gameState.score -= 0.5;
                updatePlayerStats();
                updatePlayerScore(gameState.uniquePlayerId, gameState.score);
                saveGameState();
                helpBtn.disabled = true;

                let sceneData = gameData[gameState.currentScene];
                if (Array.isArray(sceneData)) {
                    sceneData = sceneData[gameState.currentSubQuestionIndex];
                }

                const hint = (sceneData.hint && (sceneData.hint[gameState.selectedGuide] || sceneData.hint.default)) || 'ููุฑ ุฌูุฏุงูุ ููููู ูุนููุง!';
                showGuideModal("ูุณุงุนุฏุฉ ูู ูุฑุดุฏู", hint);
            }

            function updatePlayerStats() {
                playerNameDisplay.textContent = gameState.playerName;
                playerScoreDisplay.innerHTML = `๐ฐ ${gameState.score} ุฌููู`;
            }

            function showModal(title, text, callback) {
                modalTitle.textContent = title;
                modalText.innerHTML = text; // Use innerHTML to render styled guide messages
                modal.classList.remove('hidden');
                modalCloseBtn.onclick = () => {
                    modal.classList.add('hidden');
                    if (callback) callback();
                };
            }

            function endVideoAndProceed() {
                welcomeVideo.pause();
                welcomeVideo.currentTime = 0;
                videoOverlay.classList.add('hidden');
                renderScene('map');
            }

            function playWelcomeVideo() {
                videoOverlay.classList.remove('hidden');
                welcomeVideo.play();
                welcomeVideo.onended = endVideoAndProceed;
                skipVideoBtn.onclick = endVideoAndProceed;
            }

            function showAdModal() {
                adModal.classList.remove('hidden');
                adShownThisSession = true;
            }
            
            function isStageCompleted(stageId) {
                let stageData = gameData[stageId];
                if (!stageData) return false;
                if (stageId === 'faculties' || stageId === 'exchange' || stageId === 'admission' || stageId === 'studentaffairs') {
                    const subScenes = Object.values(stageData.nextScene);
                    return subScenes.every(s => isStageCompleted(s));
                }
                if (Array.isArray(stageData)) {
                    return stageData.every(q => gameState.answeredQuestions.has(q.id));
                }
                 // For single-question stages like 'gate'
                if (stageData.id) {
                    return gameState.answeredQuestions.has(stageData.id);
                }
                return false;
            }
            
            playerForm.addEventListener('submit', startGame);

            document.getElementById('map-scene').addEventListener('click', (e) => {
                const button = e.target.closest('.option-btn');
                if (!button) return;
                const destination = button.dataset.destination;
                const destinationData = gameData[destination];

                const mainDestinationId = destination.replace('-info', '');
                
                if (isStageCompleted(mainDestinationId)) {
                    showModal("ููุงู ูุฃููู!", "ููุฏ ุฃูููุช ุฌููุน ุชุญุฏูุงุช ูุฐุง ุงูููุงู. ุงุฎุชุฑ ูุฌูุฉ ุฃุฎุฑู.", null);
                    return;
                }

                if (destinationData && destinationData.isInfoScreen) {
                    const sceneMappings = {
                        'grants-info': renderGrantsInfoScene,
                        'admission-info': renderAdmissionInfoScene,
                        'faculties-list': renderFacultiesListScene,
                        'exchange-info': renderExchangeInfoScene,
                        'studentaffairs-info': renderStudentAffairsInfoScene,
                    };
                    if(sceneMappings[destination]) sceneMappings[destination]();
                    return;
                }
                
                if (destination === 'certificate') {
                    const libraryComplete = isStageCompleted('library');
                    const facultiesComplete = isStageCompleted('faculties');
                    const exchangeComplete = isStageCompleted('exchange');
                    const admissionComplete = isStageCompleted('admission');
                    const studentAffairsComplete = isStageCompleted('studentaffairs');
                    const allKeyStagesComplete = libraryComplete && facultiesComplete && exchangeComplete && admissionComplete && studentAffairsComplete;
                    const scoreSufficient = gameState.score >= 50;
                    if (allKeyStagesComplete && scoreSufficient) {
                        showEndScene();
                    } else {
                        let message = "ุงูุทุฑูู ุฅูู ุงูุดูุงุฏุฉ ูู ููุชูู ุจุนุฏ!<br><br>ููุญุตูู ุนูููุงุ ูุฌุจ ุนููู ุชุญููู ุดุฑุทูู:<br>";
                        message += `1. ุฅููุงู ุงูุชุญุฏูุงุช ุงูุฑุฆูุณูุฉ.<br>`;
                        message += `(${libraryComplete ? 'โ๏ธ' : 'โ'} ุงูููุชุจุฉ) | (${facultiesComplete ? 'โ๏ธ' : 'โ'} ุงููููุงุช) | (${exchangeComplete ? 'โ๏ธ' : 'โ'} ุงูุชุจุงุฏู) | (${admissionComplete ? 'โ๏ธ' : 'โ'} ุงููุจูู) | (${studentAffairsComplete ? 'โ๏ธ' : 'โ'} ุดุคูู ุงูุทูุจุฉ)<br>`;
                        message += `2. ุงูุญุตูู ุนูู 50 ุฌููููุง ุนูู ุงูุฃูู (ุฑุตูุฏู: ${gameState.score}). (${scoreSufficient ? 'โ๏ธ' : 'โ'})<br><br>ุงุณุชูุฑ ูู ุฑุญูุชู!`;
                        showModal("ุดุฑูุท ุงูุญุตูู ุนูู ุงูุดูุงุฏุฉ", message, null);
                    }
                    return;
                }
                
                if (destinationData && destinationData.isUnderConstruction) {
                    showModal("ููุฏ ุงูุฅูุดุงุก!", "ูุฐุง ุงูุฌุฒุก ูู ุงูุฌุงูุนุฉ ุณูุชู ุงูุชุชุงุญู ูุฑูุจุงู ูู ุงูุชุญุฏูุซุงุช ุงููุงุฏูุฉ ููุนุจุฉ.", null);
                    return;
                }

                if (destinationData) renderScene(destination);
                else showModal("ุฎุทุฃ", "ูู ูุชู ุงูุนุซูุฑ ุนูู ุงููุฌูุฉ ุงููุทููุจุฉ.", null);
            });
            
            document.addEventListener('click', function(event) {
                if (event.target.closest('#show-register-btn')) {
                    landingScreen.classList.add('hidden');
                    startScreen.classList.remove('hidden');
                }
                if (event.target.closest('#logout-btn')) {
                    event.preventDefault();
                    resetGameState();
                }
                if (event.target.closest('#back-to-map-btn')) {
                    event.preventDefault();
                    renderScene('map');
                }
            });

            adModal.addEventListener('click', (event) => {
                if (event.target.classList.contains('close-ad-btn') || event.target.id === 'ad-modal') {
                    adModal.classList.add('hidden');
                }
            });
            
            document.getElementById('new-player-btn').addEventListener('click', resetGameState);
            document.getElementById('reset-progress-btn').addEventListener('click', (e) => {
                e.preventDefault();
                resetGameState();
            });
            
            window.addEventListener('popstate', (event) => {
                if (event.state && event.state.scene) {
                    const sceneMappings = {
                        'admission-info': renderAdmissionInfoScene,
                        'exchange-info': renderExchangeInfoScene,
                        'grants-info': renderGrantsInfoScene,
                        'faculties-list': renderFacultiesListScene,
                        'studentaffairs-info': renderStudentAffairsInfoScene
                    };
                    if (sceneMappings[event.state.scene]) {
                        sceneMappings[event.state.scene]();
                    } else {
                        renderScene(event.state.scene, event.state.index, false);
                    }
                } else {
                    if (gameState.uniquePlayerId) renderScene('map', 0, false);
                    else location.reload();
                }
            });
            
            function populateFacultiesList() {
                const container = document.getElementById('faculties-grid-container');
                let content = '';
                collegesData.forEach(college => {
                    content += `<div class="college-info-card" data-url="${college.url}" data-name="${college.name}"><h3>${college.emoji} ${college.name}</h3><p>${college.description}</p></div>`;
                });
                container.innerHTML = content;
            }

            function renderFacultiesListScene() {
                document.querySelectorAll('.game-stage').forEach(stage => stage.classList.add('hidden'));
                document.getElementById('faculties-list-scene').classList.remove('hidden');
                gameState.currentScene = 'faculties-list';
                saveGameState();
            }
            
            document.getElementById('faculties-grid-container').addEventListener('click', (e) => {
                const card = e.target.closest('.college-info-card');
                if (!card) return;
                const url = card.dataset.url;
                const name = card.dataset.name;
                const websiteScene = document.getElementById('college-website-scene');
                websiteScene.innerHTML = `<div class="scene-content"><div class="website-view-header"><button id="back-to-list-btn" class="action-button" style="width: auto; padding: 10px 20px;"><span class="btn-icon">โก๏ธ</span> ุฑุฌูุน ููุงุฆูุฉ ุงููููุงุช</button></div><div class="loader-container" id="loader-container"><div class="loader"></div><p>ุฌุงุฑู ุชุญููู ุตูุญุฉ ุงููููุฉ...</p></div></div>`;
                document.getElementById('back-to-list-btn').addEventListener('click', () => {
                    websiteScene.classList.add('hidden');
                    websiteScene.innerHTML = ''; 
                    document.getElementById('faculties-list-scene').classList.remove('hidden');
                });
                document.querySelectorAll('.game-stage').forEach(stage => stage.classList.add('hidden'));
                websiteScene.classList.remove('hidden');
                const iframe = document.createElement('iframe');
                iframe.id = 'college-website-iframe';
                iframe.src = url;
                iframe.title = name;
                iframe.onload = () => {
                    const loaderContainer = document.getElementById('loader-container');
                    if (loaderContainer) loaderContainer.remove();
                    iframe.classList.add('loaded');
                };
                websiteScene.querySelector('.scene-content').appendChild(iframe);
            });

            document.getElementById('proceed-to-faculties-quiz-btn').addEventListener('click', () => {
                document.querySelectorAll('.game-stage').forEach(stage => stage.classList.add('hidden'));
                renderScene('faculties');
            });

            function populateGuideSelection() {
                const container = document.querySelector('#guide-selection-screen .guides-container');
                container.innerHTML = ''; 
                allGuides.forEach(guide => {
                    const cardHTML = `
                        <div class="guide-card" data-guide="${guide.id}">
                            <div class="guide-icon">${guide.emoji}</div>
                            <h3>${guide.name}</h3>
                            <span>${guide.college}</span>
                            <p>${guide.description}</p>
                        </div>
                    `;
                    container.innerHTML += cardHTML;
                });
            }

            const guideSelectionScreen = document.getElementById('guide-selection-screen');
            const guidesContainer = guideSelectionScreen.querySelector('.guides-container');
            const confirmGuideBtn = document.getElementById('confirm-guide-btn');
            
            guidesContainer.addEventListener('click', (e) => {
                const selectedCard = e.target.closest('.guide-card');
                if (!selectedCard) return;
                
                guidesContainer.querySelectorAll('.guide-card').forEach(card => card.classList.remove('selected'));
                selectedCard.classList.add('selected');
                
                gameState.selectedGuide = selectedCard.dataset.guide;
                confirmGuideBtn.disabled = false;
            });

            confirmGuideBtn.addEventListener('click', () => {
                if (gameState.selectedGuide) {
                    saveGameState();
                    guideSelectionScreen.classList.add('hidden');
                    gameSceneContainer.classList.remove('hidden');
                    statusBar.classList.remove('hidden');
                    showModal(`ุงุฎุชูุงุฑ ูููู!`, `ูุฑุดุฏู ุงูุฃูุงุฏููู ุณูููู ุจุฌุงูุจู. ููุจุฏุฃ ุงูุฑุญูุฉ ุงูุขู!`, () => {
                        renderScene('gate');
                    });
                }
            });
            
            document.body.addEventListener('click', unlockAudio, { once: true });
            populateFacultiesList();
            populateGuideSelection();
            restoreGameSession();
        });
    </script>
</body>
</html>
